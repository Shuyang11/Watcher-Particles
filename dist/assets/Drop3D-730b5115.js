import{L as fe,b as at,F as jt,f as et,_ as K,l as me,j as Kt,D as ye,$ as ht,S as ct,a0 as G,u as qt,g as At,a as st,a1 as ge,a2 as ve,O as Xt,T as xe,a3 as Ae,K as wt,a4 as _e,a5 as Zt,a6 as Qt,R as Mt,X as Te,a7 as St,o as Ee,a8 as Yt,a9 as Re,P as we,r as Me,m as Se,n as be,aa as Wt,ab as Pe,p as Ie,ac as Le,Y as ze,G as bt,i as Jt,k as Ue,h as Ce,q as Oe,w as De,B as Be,ad as $t,ae as te,Q as ee,af as Ne,ag as Ve,ah as He,ai as Fe,c as ke,aj as Ge,ak as je,al as Ke,am as qe,d as ie,an as Xe,ao as Ze,x as se,N as ne,z as re,ap as Qe,aq as Ye,ar as We,as as Je,at as $e,H as ti,au as ei,W as ii,A as si,I as ni}from"./BufferGeometryUtils-de005f4b.js";import{a as ri,c as oi,g as ai}from"./_commonjsHelpers-de833af9.js";import{s as hi}from"./index-091055e6.js";import{r as ci,k as li,D as ui,z as di,o as pi,c as fi}from"./vendor-e4930f4d.js";var lt=function(){var v=0,s=document.createElement("div");s.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",s.addEventListener("click",function(m){m.preventDefault(),c(++v%s.children.length)},!1);function i(m){return s.appendChild(m.dom),m}function c(m){for(var f=0;f<s.children.length;f++)s.children[f].style.display=f===m?"block":"none";v=m}var o=(performance||Date).now(),h=o,a=0,l=i(new lt.Panel("FPS","#0ff","#002")),u=i(new lt.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var p=i(new lt.Panel("MB","#f08","#201"));return c(0),{REVISION:16,dom:s,addPanel:i,showPanel:c,begin:function(){o=(performance||Date).now()},end:function(){a++;var m=(performance||Date).now();if(u.update(m-o,200),m>=h+1e3&&(l.update(a*1e3/(m-h),100),h=m,a=0,p)){var f=performance.memory;p.update(f.usedJSHeapSize/1048576,f.jsHeapSizeLimit/1048576)}return m},update:function(){o=this.end()},domElement:s,setMode:c}};lt.Panel=function(v,s,i){var c=1/0,o=0,h=Math.round,a=h(window.devicePixelRatio||1),l=80*a,u=48*a,p=3*a,m=2*a,f=3*a,g=15*a,x=74*a,R=30*a,E=document.createElement("canvas");E.width=l,E.height=u,E.style.cssText="width:80px;height:48px";var A=E.getContext("2d");return A.font="bold "+9*a+"px Helvetica,Arial,sans-serif",A.textBaseline="top",A.fillStyle=i,A.fillRect(0,0,l,u),A.fillStyle=s,A.fillText(v,p,m),A.fillRect(f,g,x,R),A.fillStyle=i,A.globalAlpha=.9,A.fillRect(f,g,x,R),{dom:E,update:function(_,M){c=Math.min(c,_),o=Math.max(o,_),A.fillStyle=i,A.globalAlpha=1,A.fillRect(0,0,l,g),A.fillStyle=s,A.fillText(h(_)+" "+v+" ("+h(c)+"-"+h(o)+")",p,m),A.drawImage(E,f+a,g,x-a,R,f,g,x-a,R),A.fillRect(f+x-a,g,a,R),A.fillStyle=i,A.globalAlpha=.9,A.fillRect(f+x-a,g,a,h((1-_/M)*R))}}};const mi=lt;class yi extends fe{constructor(s){super(s),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(i){return new _i(i)}),this.register(function(i){return new Ti(i)}),this.register(function(i){return new Li(i)}),this.register(function(i){return new zi(i)}),this.register(function(i){return new Ui(i)}),this.register(function(i){return new Ri(i)}),this.register(function(i){return new wi(i)}),this.register(function(i){return new Mi(i)}),this.register(function(i){return new Si(i)}),this.register(function(i){return new Ai(i)}),this.register(function(i){return new bi(i)}),this.register(function(i){return new Ei(i)}),this.register(function(i){return new Ii(i)}),this.register(function(i){return new Pi(i)}),this.register(function(i){return new vi(i)}),this.register(function(i){return new Ci(i)}),this.register(function(i){return new Oi(i)})}load(s,i,c,o){const h=this;let a;if(this.resourcePath!=="")a=this.resourcePath;else if(this.path!==""){const p=at.extractUrlBase(s);a=at.resolveURL(p,this.path)}else a=at.extractUrlBase(s);this.manager.itemStart(s);const l=function(p){o?o(p):console.error(p),h.manager.itemError(s),h.manager.itemEnd(s)},u=new jt(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(s,function(p){try{h.parse(p,a,function(m){i(m),h.manager.itemEnd(s)},l)}catch(m){l(m)}},c,l)}setDRACOLoader(s){return this.dracoLoader=s,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(s){return this.ktx2Loader=s,this}setMeshoptDecoder(s){return this.meshoptDecoder=s,this}register(s){return this.pluginCallbacks.indexOf(s)===-1&&this.pluginCallbacks.push(s),this}unregister(s){return this.pluginCallbacks.indexOf(s)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(s),1),this}parse(s,i,c,o){let h;const a={},l={},u=new TextDecoder;if(typeof s=="string")h=JSON.parse(s);else if(s instanceof ArrayBuffer)if(u.decode(new Uint8Array(s,0,4))===oe){try{a[b.KHR_BINARY_GLTF]=new Di(s)}catch(m){o&&o(m);return}h=JSON.parse(a[b.KHR_BINARY_GLTF].content)}else h=JSON.parse(u.decode(s));else h=s;if(h.asset===void 0||h.asset.version[0]<2){o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const p=new Qi(h,{path:i||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});p.fileLoader.setRequestHeader(this.requestHeader);for(let m=0;m<this.pluginCallbacks.length;m++){const f=this.pluginCallbacks[m](p);f.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),l[f.name]=f,a[f.name]=!0}if(h.extensionsUsed)for(let m=0;m<h.extensionsUsed.length;++m){const f=h.extensionsUsed[m],g=h.extensionsRequired||[];switch(f){case b.KHR_MATERIALS_UNLIT:a[f]=new xi;break;case b.KHR_DRACO_MESH_COMPRESSION:a[f]=new Bi(h,this.dracoLoader);break;case b.KHR_TEXTURE_TRANSFORM:a[f]=new Ni;break;case b.KHR_MESH_QUANTIZATION:a[f]=new Vi;break;default:g.indexOf(f)>=0&&l[f]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}p.setExtensions(a),p.setPlugins(l),p.parse(c,o)}parseAsync(s,i){const c=this;return new Promise(function(o,h){c.parse(s,i,o,h)})}}function gi(){let v={};return{get:function(s){return v[s]},add:function(s,i){v[s]=i},remove:function(s){delete v[s]},removeAll:function(){v={}}}}const b={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class vi{constructor(s){this.parser=s,this.name=b.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const s=this.parser,i=this.parser.json.nodes||[];for(let c=0,o=i.length;c<o;c++){const h=i[c];h.extensions&&h.extensions[this.name]&&h.extensions[this.name].light!==void 0&&s._addNodeRef(this.cache,h.extensions[this.name].light)}}_loadLight(s){const i=this.parser,c="light:"+s;let o=i.cache.get(c);if(o)return o;const h=i.json,a=((h.extensions&&h.extensions[this.name]||{}).lights||[])[s];let l;const u=new et(16777215);a.color!==void 0&&u.setRGB(a.color[0],a.color[1],a.color[2],K);const p=a.range!==void 0?a.range:0;switch(a.type){case"directional":l=new ye(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new Kt(u),l.distance=p;break;case"spot":l=new me(u),l.distance=p,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle!==void 0?a.spot.innerConeAngle:0,a.spot.outerConeAngle=a.spot.outerConeAngle!==void 0?a.spot.outerConeAngle:Math.PI/4,l.angle=a.spot.outerConeAngle,l.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return l.position.set(0,0,0),l.decay=2,q(l,a),a.intensity!==void 0&&(l.intensity=a.intensity),l.name=i.createUniqueName(a.name||"light_"+s),o=Promise.resolve(l),i.cache.add(c,o),o}getDependency(s,i){if(s==="light")return this._loadLight(i)}createNodeAttachment(s){const i=this,c=this.parser,o=c.json.nodes[s],h=(o.extensions&&o.extensions[this.name]||{}).light;return h===void 0?null:this._loadLight(h).then(function(a){return c._getNodeRef(i.cache,h,a)})}}class xi{constructor(){this.name=b.KHR_MATERIALS_UNLIT}getMaterialType(){return ht}extendParams(s,i,c){const o=[];s.color=new et(1,1,1),s.opacity=1;const h=i.pbrMetallicRoughness;if(h){if(Array.isArray(h.baseColorFactor)){const a=h.baseColorFactor;s.color.setRGB(a[0],a[1],a[2],K),s.opacity=a[3]}h.baseColorTexture!==void 0&&o.push(c.assignTexture(s,"map",h.baseColorTexture,ct))}return Promise.all(o)}}class Ai{constructor(s){this.parser=s,this.name=b.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(s,i){const c=this.parser.json.materials[s];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const o=c.extensions[this.name].emissiveStrength;return o!==void 0&&(i.emissiveIntensity=o),Promise.resolve()}}class _i{constructor(s){this.parser=s,this.name=b.KHR_MATERIALS_CLEARCOAT}getMaterialType(s){const i=this.parser.json.materials[s];return!i.extensions||!i.extensions[this.name]?null:G}extendMaterialParams(s,i){const c=this.parser,o=c.json.materials[s];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const h=[],a=o.extensions[this.name];if(a.clearcoatFactor!==void 0&&(i.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&h.push(c.assignTexture(i,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(i.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&h.push(c.assignTexture(i,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(h.push(c.assignTexture(i,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const l=a.clearcoatNormalTexture.scale;i.clearcoatNormalScale=new qt(l,l)}return Promise.all(h)}}class Ti{constructor(s){this.parser=s,this.name=b.KHR_MATERIALS_DISPERSION}getMaterialType(s){const i=this.parser.json.materials[s];return!i.extensions||!i.extensions[this.name]?null:G}extendMaterialParams(s,i){const c=this.parser.json.materials[s];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const o=c.extensions[this.name];return i.dispersion=o.dispersion!==void 0?o.dispersion:0,Promise.resolve()}}class Ei{constructor(s){this.parser=s,this.name=b.KHR_MATERIALS_IRIDESCENCE}getMaterialType(s){const i=this.parser.json.materials[s];return!i.extensions||!i.extensions[this.name]?null:G}extendMaterialParams(s,i){const c=this.parser,o=c.json.materials[s];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const h=[],a=o.extensions[this.name];return a.iridescenceFactor!==void 0&&(i.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&h.push(c.assignTexture(i,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(i.iridescenceIOR=a.iridescenceIor),i.iridescenceThicknessRange===void 0&&(i.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(i.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(i.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&h.push(c.assignTexture(i,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(h)}}class Ri{constructor(s){this.parser=s,this.name=b.KHR_MATERIALS_SHEEN}getMaterialType(s){const i=this.parser.json.materials[s];return!i.extensions||!i.extensions[this.name]?null:G}extendMaterialParams(s,i){const c=this.parser,o=c.json.materials[s];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const h=[];i.sheenColor=new et(0,0,0),i.sheenRoughness=0,i.sheen=1;const a=o.extensions[this.name];if(a.sheenColorFactor!==void 0){const l=a.sheenColorFactor;i.sheenColor.setRGB(l[0],l[1],l[2],K)}return a.sheenRoughnessFactor!==void 0&&(i.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&h.push(c.assignTexture(i,"sheenColorMap",a.sheenColorTexture,ct)),a.sheenRoughnessTexture!==void 0&&h.push(c.assignTexture(i,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(h)}}class wi{constructor(s){this.parser=s,this.name=b.KHR_MATERIALS_TRANSMISSION}getMaterialType(s){const i=this.parser.json.materials[s];return!i.extensions||!i.extensions[this.name]?null:G}extendMaterialParams(s,i){const c=this.parser,o=c.json.materials[s];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const h=[],a=o.extensions[this.name];return a.transmissionFactor!==void 0&&(i.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&h.push(c.assignTexture(i,"transmissionMap",a.transmissionTexture)),Promise.all(h)}}class Mi{constructor(s){this.parser=s,this.name=b.KHR_MATERIALS_VOLUME}getMaterialType(s){const i=this.parser.json.materials[s];return!i.extensions||!i.extensions[this.name]?null:G}extendMaterialParams(s,i){const c=this.parser,o=c.json.materials[s];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const h=[],a=o.extensions[this.name];i.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&h.push(c.assignTexture(i,"thicknessMap",a.thicknessTexture)),i.attenuationDistance=a.attenuationDistance||1/0;const l=a.attenuationColor||[1,1,1];return i.attenuationColor=new et().setRGB(l[0],l[1],l[2],K),Promise.all(h)}}class Si{constructor(s){this.parser=s,this.name=b.KHR_MATERIALS_IOR}getMaterialType(s){const i=this.parser.json.materials[s];return!i.extensions||!i.extensions[this.name]?null:G}extendMaterialParams(s,i){const c=this.parser.json.materials[s];if(!c.extensions||!c.extensions[this.name])return Promise.resolve();const o=c.extensions[this.name];return i.ior=o.ior!==void 0?o.ior:1.5,Promise.resolve()}}class bi{constructor(s){this.parser=s,this.name=b.KHR_MATERIALS_SPECULAR}getMaterialType(s){const i=this.parser.json.materials[s];return!i.extensions||!i.extensions[this.name]?null:G}extendMaterialParams(s,i){const c=this.parser,o=c.json.materials[s];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const h=[],a=o.extensions[this.name];i.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&h.push(c.assignTexture(i,"specularIntensityMap",a.specularTexture));const l=a.specularColorFactor||[1,1,1];return i.specularColor=new et().setRGB(l[0],l[1],l[2],K),a.specularColorTexture!==void 0&&h.push(c.assignTexture(i,"specularColorMap",a.specularColorTexture,ct)),Promise.all(h)}}class Pi{constructor(s){this.parser=s,this.name=b.EXT_MATERIALS_BUMP}getMaterialType(s){const i=this.parser.json.materials[s];return!i.extensions||!i.extensions[this.name]?null:G}extendMaterialParams(s,i){const c=this.parser,o=c.json.materials[s];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const h=[],a=o.extensions[this.name];return i.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1,a.bumpTexture!==void 0&&h.push(c.assignTexture(i,"bumpMap",a.bumpTexture)),Promise.all(h)}}class Ii{constructor(s){this.parser=s,this.name=b.KHR_MATERIALS_ANISOTROPY}getMaterialType(s){const i=this.parser.json.materials[s];return!i.extensions||!i.extensions[this.name]?null:G}extendMaterialParams(s,i){const c=this.parser,o=c.json.materials[s];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const h=[],a=o.extensions[this.name];return a.anisotropyStrength!==void 0&&(i.anisotropy=a.anisotropyStrength),a.anisotropyRotation!==void 0&&(i.anisotropyRotation=a.anisotropyRotation),a.anisotropyTexture!==void 0&&h.push(c.assignTexture(i,"anisotropyMap",a.anisotropyTexture)),Promise.all(h)}}class Li{constructor(s){this.parser=s,this.name=b.KHR_TEXTURE_BASISU}loadTexture(s){const i=this.parser,c=i.json,o=c.textures[s];if(!o.extensions||!o.extensions[this.name])return null;const h=o.extensions[this.name],a=i.options.ktx2Loader;if(!a){if(c.extensionsRequired&&c.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return i.loadTextureImage(s,h.source,a)}}class zi{constructor(s){this.parser=s,this.name=b.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(s){const i=this.name,c=this.parser,o=c.json,h=o.textures[s];if(!h.extensions||!h.extensions[i])return null;const a=h.extensions[i],l=o.images[a.source];let u=c.textureLoader;if(l.uri){const p=c.options.manager.getHandler(l.uri);p!==null&&(u=p)}return this.detectSupport().then(function(p){if(p)return c.loadTextureImage(s,a.source,u);if(o.extensionsRequired&&o.extensionsRequired.indexOf(i)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return c.loadTexture(s)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(s){const i=new Image;i.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",i.onload=i.onerror=function(){s(i.height===1)}})),this.isSupported}}class Ui{constructor(s){this.parser=s,this.name=b.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(s){const i=this.name,c=this.parser,o=c.json,h=o.textures[s];if(!h.extensions||!h.extensions[i])return null;const a=h.extensions[i],l=o.images[a.source];let u=c.textureLoader;if(l.uri){const p=c.options.manager.getHandler(l.uri);p!==null&&(u=p)}return this.detectSupport().then(function(p){if(p)return c.loadTextureImage(s,a.source,u);if(o.extensionsRequired&&o.extensionsRequired.indexOf(i)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return c.loadTexture(s)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(s){const i=new Image;i.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",i.onload=i.onerror=function(){s(i.height===1)}})),this.isSupported}}class Ci{constructor(s){this.name=b.EXT_MESHOPT_COMPRESSION,this.parser=s}loadBufferView(s){const i=this.parser.json,c=i.bufferViews[s];if(c.extensions&&c.extensions[this.name]){const o=c.extensions[this.name],h=this.parser.getDependency("buffer",o.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return h.then(function(l){const u=o.byteOffset||0,p=o.byteLength||0,m=o.count,f=o.byteStride,g=new Uint8Array(l,u,p);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(m,f,g,o.mode,o.filter).then(function(x){return x.buffer}):a.ready.then(function(){const x=new ArrayBuffer(m*f);return a.decodeGltfBuffer(new Uint8Array(x),m,f,g,o.mode,o.filter),x})})}else return null}}class Oi{constructor(s){this.name=b.EXT_MESH_GPU_INSTANCING,this.parser=s}createNodeMesh(s){const i=this.parser.json,c=i.nodes[s];if(!c.extensions||!c.extensions[this.name]||c.mesh===void 0)return null;const o=i.meshes[c.mesh];for(const u of o.primitives)if(u.mode!==V.TRIANGLES&&u.mode!==V.TRIANGLE_STRIP&&u.mode!==V.TRIANGLE_FAN&&u.mode!==void 0)return null;const h=c.extensions[this.name].attributes,a=[],l={};for(const u in h)a.push(this.parser.getDependency("accessor",h[u]).then(p=>(l[u]=p,l[u])));return a.length<1?null:(a.push(this.parser.createNodeMesh(s)),Promise.all(a).then(u=>{const p=u.pop(),m=p.isGroup?p.children:[p],f=u[0].count,g=[];for(const x of m){const R=new At,E=new st,A=new ee,_=new st(1,1,1),M=new ge(x.geometry,x.material,f);for(let P=0;P<f;P++)l.TRANSLATION&&E.fromBufferAttribute(l.TRANSLATION,P),l.ROTATION&&A.fromBufferAttribute(l.ROTATION,P),l.SCALE&&_.fromBufferAttribute(l.SCALE,P),M.setMatrixAt(P,R.compose(E,A,_));for(const P in l)if(P==="_COLOR_0"){const L=l[P];M.instanceColor=new ve(L.array,L.itemSize,L.normalized)}else P!=="TRANSLATION"&&P!=="ROTATION"&&P!=="SCALE"&&x.geometry.setAttribute(P,l[P]);Xt.prototype.copy.call(M,x),this.parser.assignFinalMaterial(M),g.push(M)}return p.isGroup?(p.clear(),p.add(...g),p):g[0]}))}}const oe="glTF",ut=12,ae={JSON:1313821514,BIN:5130562};class Di{constructor(s){this.name=b.KHR_BINARY_GLTF,this.content=null,this.body=null;const i=new DataView(s,0,ut),c=new TextDecoder;if(this.header={magic:c.decode(new Uint8Array(s.slice(0,4))),version:i.getUint32(4,!0),length:i.getUint32(8,!0)},this.header.magic!==oe)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const o=this.header.length-ut,h=new DataView(s,ut);let a=0;for(;a<o;){const l=h.getUint32(a,!0);a+=4;const u=h.getUint32(a,!0);if(a+=4,u===ae.JSON){const p=new Uint8Array(s,ut+a,l);this.content=c.decode(p)}else if(u===ae.BIN){const p=ut+a;this.body=s.slice(p,p+l)}a+=l}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Bi{constructor(s,i){if(!i)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=b.KHR_DRACO_MESH_COMPRESSION,this.json=s,this.dracoLoader=i,this.dracoLoader.preload()}decodePrimitive(s,i){const c=this.json,o=this.dracoLoader,h=s.extensions[this.name].bufferView,a=s.extensions[this.name].attributes,l={},u={},p={};for(const m in a){const f=It[m]||m.toLowerCase();l[f]=a[m]}for(const m in s.attributes){const f=It[m]||m.toLowerCase();if(a[m]!==void 0){const g=c.accessors[s.attributes[m]],x=nt[g.componentType];p[f]=x.name,u[f]=g.normalized===!0}}return i.getDependency("bufferView",h).then(function(m){return new Promise(function(f,g){o.decodeDracoFile(m,function(x){for(const R in x.attributes){const E=x.attributes[R],A=u[R];A!==void 0&&(E.normalized=A)}f(x)},l,p,K,g)})})}}class Ni{constructor(){this.name=b.KHR_TEXTURE_TRANSFORM}extendTexture(s,i){return(i.texCoord===void 0||i.texCoord===s.channel)&&i.offset===void 0&&i.rotation===void 0&&i.scale===void 0||(s=s.clone(),i.texCoord!==void 0&&(s.channel=i.texCoord),i.offset!==void 0&&s.offset.fromArray(i.offset),i.rotation!==void 0&&(s.rotation=i.rotation),i.scale!==void 0&&s.repeat.fromArray(i.scale),s.needsUpdate=!0),s}}class Vi{constructor(){this.name=b.KHR_MESH_QUANTIZATION}}class he extends We{constructor(s,i,c,o){super(s,i,c,o)}copySampleValue_(s){const i=this.resultBuffer,c=this.sampleValues,o=this.valueSize,h=s*o*3+o;for(let a=0;a!==o;a++)i[a]=c[h+a];return i}interpolate_(s,i,c,o){const h=this.resultBuffer,a=this.sampleValues,l=this.valueSize,u=l*2,p=l*3,m=o-i,f=(c-i)/m,g=f*f,x=g*f,R=s*p,E=R-p,A=-2*x+3*g,_=x-g,M=1-A,P=_-g+f;for(let L=0;L!==l;L++){const D=a[E+L+l],I=a[E+L+u]*m,w=a[R+L+l],U=a[R+L]*m;h[L]=M*D+P*I+A*w+_*U}return h}}const Hi=new ee;class Fi extends he{interpolate_(s,i,c,o){const h=super.interpolate_(s,i,c,o);return Hi.fromArray(h).normalize().toArray(h),h}}const V={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},nt={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ce={9728:Ne,9729:Zt,9984:Ve,9985:He,9986:Fe,9987:Qt},le={33071:ke,33648:Ge,10497:Mt},Pt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},It={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},X={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ki={CUBICSPLINE:void 0,LINEAR:$t,STEP:je},Lt={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Gi(v){return v.DefaultMaterial===void 0&&(v.DefaultMaterial=new Yt({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ke})),v.DefaultMaterial}function it(v,s,i){for(const c in i.extensions)v[c]===void 0&&(s.userData.gltfExtensions=s.userData.gltfExtensions||{},s.userData.gltfExtensions[c]=i.extensions[c])}function q(v,s){s.extras!==void 0&&(typeof s.extras=="object"?Object.assign(v.userData,s.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+s.extras))}function ji(v,s,i){let c=!1,o=!1,h=!1;for(let p=0,m=s.length;p<m;p++){const f=s[p];if(f.POSITION!==void 0&&(c=!0),f.NORMAL!==void 0&&(o=!0),f.COLOR_0!==void 0&&(h=!0),c&&o&&h)break}if(!c&&!o&&!h)return Promise.resolve(v);const a=[],l=[],u=[];for(let p=0,m=s.length;p<m;p++){const f=s[p];if(c){const g=f.POSITION!==void 0?i.getDependency("accessor",f.POSITION):v.attributes.position;a.push(g)}if(o){const g=f.NORMAL!==void 0?i.getDependency("accessor",f.NORMAL):v.attributes.normal;l.push(g)}if(h){const g=f.COLOR_0!==void 0?i.getDependency("accessor",f.COLOR_0):v.attributes.color;u.push(g)}}return Promise.all([Promise.all(a),Promise.all(l),Promise.all(u)]).then(function(p){const m=p[0],f=p[1],g=p[2];return c&&(v.morphAttributes.position=m),o&&(v.morphAttributes.normal=f),h&&(v.morphAttributes.color=g),v.morphTargetsRelative=!0,v})}function Ki(v,s){if(v.updateMorphTargets(),s.weights!==void 0)for(let i=0,c=s.weights.length;i<c;i++)v.morphTargetInfluences[i]=s.weights[i];if(s.extras&&Array.isArray(s.extras.targetNames)){const i=s.extras.targetNames;if(v.morphTargetInfluences.length===i.length){v.morphTargetDictionary={};for(let c=0,o=i.length;c<o;c++)v.morphTargetDictionary[i[c]]=c}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function qi(v){let s;const i=v.extensions&&v.extensions[b.KHR_DRACO_MESH_COMPRESSION];if(i?s="draco:"+i.bufferView+":"+i.indices+":"+zt(i.attributes):s=v.indices+":"+zt(v.attributes)+":"+v.mode,v.targets!==void 0)for(let c=0,o=v.targets.length;c<o;c++)s+=":"+zt(v.targets[c]);return s}function zt(v){let s="";const i=Object.keys(v).sort();for(let c=0,o=i.length;c<o;c++)s+=i[c]+":"+v[i[c]]+";";return s}function Ut(v){switch(v){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Xi(v){return v.search(/\.jpe?g($|\?)/i)>0||v.search(/^data\:image\/jpeg/)===0?"image/jpeg":v.search(/\.webp($|\?)/i)>0||v.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Zi=new At;class Qi{constructor(s={},i={}){this.json=s,this.extensions={},this.plugins={},this.options=i,this.cache=new gi,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let c=!1,o=-1,h=!1,a=-1;if(typeof navigator<"u"){const l=navigator.userAgent;c=/^((?!chrome|android).)*safari/i.test(l)===!0;const u=l.match(/Version\/(\d+)/);o=c&&u?parseInt(u[1],10):-1,h=l.indexOf("Firefox")>-1,a=h?l.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||c&&o<17||h&&a<98?this.textureLoader=new xe(this.options.manager):this.textureLoader=new Ae(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new jt(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(s){this.extensions=s}setPlugins(s){this.plugins=s}parse(s,i){const c=this,o=this.json,h=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([c.getDependencies("scene"),c.getDependencies("animation"),c.getDependencies("camera")])}).then(function(a){const l={scene:a[0][o.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:o.asset,parser:c,userData:{}};return it(h,l,o),q(l,o),Promise.all(c._invokeAll(function(u){return u.afterRoot&&u.afterRoot(l)})).then(function(){for(const u of l.scenes)u.updateMatrixWorld();s(l)})}).catch(i)}_markDefs(){const s=this.json.nodes||[],i=this.json.skins||[],c=this.json.meshes||[];for(let o=0,h=i.length;o<h;o++){const a=i[o].joints;for(let l=0,u=a.length;l<u;l++)s[a[l]].isBone=!0}for(let o=0,h=s.length;o<h;o++){const a=s[o];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(c[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(s,i){i!==void 0&&(s.refs[i]===void 0&&(s.refs[i]=s.uses[i]=0),s.refs[i]++)}_getNodeRef(s,i,c){if(s.refs[i]<=1)return c;const o=c.clone(),h=(a,l)=>{const u=this.associations.get(a);u!=null&&this.associations.set(l,u);for(const[p,m]of a.children.entries())h(m,l.children[p])};return h(c,o),o.name+="_instance_"+s.uses[i]++,o}_invokeOne(s){const i=Object.values(this.plugins);i.push(this);for(let c=0;c<i.length;c++){const o=s(i[c]);if(o)return o}return null}_invokeAll(s){const i=Object.values(this.plugins);i.unshift(this);const c=[];for(let o=0;o<i.length;o++){const h=s(i[o]);h&&c.push(h)}return c}getDependency(s,i){const c=s+":"+i;let o=this.cache.get(c);if(!o){switch(s){case"scene":o=this.loadScene(i);break;case"node":o=this._invokeOne(function(h){return h.loadNode&&h.loadNode(i)});break;case"mesh":o=this._invokeOne(function(h){return h.loadMesh&&h.loadMesh(i)});break;case"accessor":o=this.loadAccessor(i);break;case"bufferView":o=this._invokeOne(function(h){return h.loadBufferView&&h.loadBufferView(i)});break;case"buffer":o=this.loadBuffer(i);break;case"material":o=this._invokeOne(function(h){return h.loadMaterial&&h.loadMaterial(i)});break;case"texture":o=this._invokeOne(function(h){return h.loadTexture&&h.loadTexture(i)});break;case"skin":o=this.loadSkin(i);break;case"animation":o=this._invokeOne(function(h){return h.loadAnimation&&h.loadAnimation(i)});break;case"camera":o=this.loadCamera(i);break;default:if(o=this._invokeOne(function(h){return h!=this&&h.getDependency&&h.getDependency(s,i)}),!o)throw new Error("Unknown type: "+s);break}this.cache.add(c,o)}return o}getDependencies(s){let i=this.cache.get(s);if(!i){const c=this,o=this.json[s+(s==="mesh"?"es":"s")]||[];i=Promise.all(o.map(function(h,a){return c.getDependency(s,a)})),this.cache.add(s,i)}return i}loadBuffer(s){const i=this.json.buffers[s],c=this.fileLoader;if(i.type&&i.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+i.type+" buffer type is not supported.");if(i.uri===void 0&&s===0)return Promise.resolve(this.extensions[b.KHR_BINARY_GLTF].body);const o=this.options;return new Promise(function(h,a){c.load(at.resolveURL(i.uri,o.path),h,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+i.uri+'".'))})})}loadBufferView(s){const i=this.json.bufferViews[s];return this.getDependency("buffer",i.buffer).then(function(c){const o=i.byteLength||0,h=i.byteOffset||0;return c.slice(h,h+o)})}loadAccessor(s){const i=this,c=this.json,o=this.json.accessors[s];if(o.bufferView===void 0&&o.sparse===void 0){const a=Pt[o.type],l=nt[o.componentType],u=o.normalized===!0,p=new l(o.count*a);return Promise.resolve(new wt(p,a,u))}const h=[];return o.bufferView!==void 0?h.push(this.getDependency("bufferView",o.bufferView)):h.push(null),o.sparse!==void 0&&(h.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),h.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(h).then(function(a){const l=a[0],u=Pt[o.type],p=nt[o.componentType],m=p.BYTES_PER_ELEMENT,f=m*u,g=o.byteOffset||0,x=o.bufferView!==void 0?c.bufferViews[o.bufferView].byteStride:void 0,R=o.normalized===!0;let E,A;if(x&&x!==f){const _=Math.floor(g/x),M="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+_+":"+o.count;let P=i.cache.get(M);P||(E=new p(l,_*x,o.count*x/m),P=new _e(E,x/m),i.cache.add(M,P)),A=new qe(P,u,g%x/m,R)}else l===null?E=new p(o.count*u):E=new p(l,g,o.count*u),A=new wt(E,u,R);if(o.sparse!==void 0){const _=Pt.SCALAR,M=nt[o.sparse.indices.componentType],P=o.sparse.indices.byteOffset||0,L=o.sparse.values.byteOffset||0,D=new M(a[1],P,o.sparse.count*_),I=new p(a[2],L,o.sparse.count*u);l!==null&&(A=new wt(A.array.slice(),A.itemSize,A.normalized));for(let w=0,U=D.length;w<U;w++){const O=D[w];if(A.setX(O,I[w*u]),u>=2&&A.setY(O,I[w*u+1]),u>=3&&A.setZ(O,I[w*u+2]),u>=4&&A.setW(O,I[w*u+3]),u>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return A})}loadTexture(s){const i=this.json,c=this.options,o=i.textures[s].source,h=i.images[o];let a=this.textureLoader;if(h.uri){const l=c.manager.getHandler(h.uri);l!==null&&(a=l)}return this.loadTextureImage(s,o,a)}loadTextureImage(s,i,c){const o=this,h=this.json,a=h.textures[s],l=h.images[i],u=(l.uri||l.bufferView)+":"+a.sampler;if(this.textureCache[u])return this.textureCache[u];const p=this.loadImageSource(i,c).then(function(m){m.flipY=!1,m.name=a.name||l.name||"",m.name===""&&typeof l.uri=="string"&&l.uri.startsWith("data:image/")===!1&&(m.name=l.uri);const f=(h.samplers||{})[a.sampler]||{};return m.magFilter=ce[f.magFilter]||Zt,m.minFilter=ce[f.minFilter]||Qt,m.wrapS=le[f.wrapS]||Mt,m.wrapT=le[f.wrapT]||Mt,o.associations.set(m,{textures:s}),m}).catch(function(){return null});return this.textureCache[u]=p,p}loadImageSource(s,i){const c=this,o=this.json,h=this.options;if(this.sourceCache[s]!==void 0)return this.sourceCache[s].then(f=>f.clone());const a=o.images[s],l=self.URL||self.webkitURL;let u=a.uri||"",p=!1;if(a.bufferView!==void 0)u=c.getDependency("bufferView",a.bufferView).then(function(f){p=!0;const g=new Blob([f],{type:a.mimeType});return u=l.createObjectURL(g),u});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+s+" is missing URI and bufferView");const m=Promise.resolve(u).then(function(f){return new Promise(function(g,x){let R=g;i.isImageBitmapLoader===!0&&(R=function(E){const A=new ie(E);A.needsUpdate=!0,g(A)}),i.load(at.resolveURL(f,h.path),R,void 0,x)})}).then(function(f){return p===!0&&l.revokeObjectURL(u),q(f,a),f.userData.mimeType=a.mimeType||Xi(a.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",u),f});return this.sourceCache[s]=m,m}assignTexture(s,i,c,o){const h=this;return this.getDependency("texture",c.index).then(function(a){if(!a)return null;if(c.texCoord!==void 0&&c.texCoord>0&&(a=a.clone(),a.channel=c.texCoord),h.extensions[b.KHR_TEXTURE_TRANSFORM]){const l=c.extensions!==void 0?c.extensions[b.KHR_TEXTURE_TRANSFORM]:void 0;if(l){const u=h.associations.get(a);a=h.extensions[b.KHR_TEXTURE_TRANSFORM].extendTexture(a,l),h.associations.set(a,u)}}return o!==void 0&&(a.colorSpace=o),s[i]=a,a})}assignFinalMaterial(s){const i=s.geometry;let c=s.material;const o=i.attributes.tangent===void 0,h=i.attributes.color!==void 0,a=i.attributes.normal===void 0;if(s.isPoints){const l="PointsMaterial:"+c.uuid;let u=this.cache.get(l);u||(u=new Te,St.prototype.copy.call(u,c),u.color.copy(c.color),u.map=c.map,u.sizeAttenuation=!1,this.cache.add(l,u)),c=u}else if(s.isLine){const l="LineBasicMaterial:"+c.uuid;let u=this.cache.get(l);u||(u=new Ee,St.prototype.copy.call(u,c),u.color.copy(c.color),u.map=c.map,this.cache.add(l,u)),c=u}if(o||h||a){let l="ClonedMaterial:"+c.uuid+":";o&&(l+="derivative-tangents:"),h&&(l+="vertex-colors:"),a&&(l+="flat-shading:");let u=this.cache.get(l);u||(u=c.clone(),h&&(u.vertexColors=!0),a&&(u.flatShading=!0),o&&(u.normalScale&&(u.normalScale.y*=-1),u.clearcoatNormalScale&&(u.clearcoatNormalScale.y*=-1)),this.cache.add(l,u),this.associations.set(u,this.associations.get(c))),c=u}s.material=c}getMaterialType(){return Yt}loadMaterial(s){const i=this,c=this.json,o=this.extensions,h=c.materials[s];let a;const l={},u=h.extensions||{},p=[];if(u[b.KHR_MATERIALS_UNLIT]){const f=o[b.KHR_MATERIALS_UNLIT];a=f.getMaterialType(),p.push(f.extendParams(l,h,i))}else{const f=h.pbrMetallicRoughness||{};if(l.color=new et(1,1,1),l.opacity=1,Array.isArray(f.baseColorFactor)){const g=f.baseColorFactor;l.color.setRGB(g[0],g[1],g[2],K),l.opacity=g[3]}f.baseColorTexture!==void 0&&p.push(i.assignTexture(l,"map",f.baseColorTexture,ct)),l.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,l.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(p.push(i.assignTexture(l,"metalnessMap",f.metallicRoughnessTexture)),p.push(i.assignTexture(l,"roughnessMap",f.metallicRoughnessTexture))),a=this._invokeOne(function(g){return g.getMaterialType&&g.getMaterialType(s)}),p.push(Promise.all(this._invokeAll(function(g){return g.extendMaterialParams&&g.extendMaterialParams(s,l)})))}h.doubleSided===!0&&(l.side=Re);const m=h.alphaMode||Lt.OPAQUE;if(m===Lt.BLEND?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,m===Lt.MASK&&(l.alphaTest=h.alphaCutoff!==void 0?h.alphaCutoff:.5)),h.normalTexture!==void 0&&a!==ht&&(p.push(i.assignTexture(l,"normalMap",h.normalTexture)),l.normalScale=new qt(1,1),h.normalTexture.scale!==void 0)){const f=h.normalTexture.scale;l.normalScale.set(f,f)}if(h.occlusionTexture!==void 0&&a!==ht&&(p.push(i.assignTexture(l,"aoMap",h.occlusionTexture)),h.occlusionTexture.strength!==void 0&&(l.aoMapIntensity=h.occlusionTexture.strength)),h.emissiveFactor!==void 0&&a!==ht){const f=h.emissiveFactor;l.emissive=new et().setRGB(f[0],f[1],f[2],K)}return h.emissiveTexture!==void 0&&a!==ht&&p.push(i.assignTexture(l,"emissiveMap",h.emissiveTexture,ct)),Promise.all(p).then(function(){const f=new a(l);return h.name&&(f.name=h.name),q(f,h),i.associations.set(f,{materials:s}),h.extensions&&it(o,f,h),f})}createUniqueName(s){const i=we.sanitizeNodeName(s||"");return i in this.nodeNamesUsed?i+"_"+ ++this.nodeNamesUsed[i]:(this.nodeNamesUsed[i]=0,i)}loadGeometries(s){const i=this,c=this.extensions,o=this.primitiveCache;function h(l){return c[b.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(l,i).then(function(u){return ue(u,l,i)})}const a=[];for(let l=0,u=s.length;l<u;l++){const p=s[l],m=qi(p),f=o[m];if(f)a.push(f.promise);else{let g;p.extensions&&p.extensions[b.KHR_DRACO_MESH_COMPRESSION]?g=h(p):g=ue(new Me,p,i),o[m]={primitive:p,promise:g},a.push(g)}}return Promise.all(a)}loadMesh(s){const i=this,c=this.json,o=this.extensions,h=c.meshes[s],a=h.primitives,l=[];for(let u=0,p=a.length;u<p;u++){const m=a[u].material===void 0?Gi(this.cache):this.getDependency("material",a[u].material);l.push(m)}return l.push(i.loadGeometries(a)),Promise.all(l).then(function(u){const p=u.slice(0,u.length-1),m=u[u.length-1],f=[];for(let x=0,R=m.length;x<R;x++){const E=m[x],A=a[x];let _;const M=p[x];if(A.mode===V.TRIANGLES||A.mode===V.TRIANGLE_STRIP||A.mode===V.TRIANGLE_FAN||A.mode===void 0)_=h.isSkinnedMesh===!0?new Se(E,M):new be(E,M),_.isSkinnedMesh===!0&&_.normalizeSkinWeights(),A.mode===V.TRIANGLE_STRIP?_.geometry=Wt(_.geometry,Xe):A.mode===V.TRIANGLE_FAN&&(_.geometry=Wt(_.geometry,Ze));else if(A.mode===V.LINES)_=new Pe(E,M);else if(A.mode===V.LINE_STRIP)_=new Ie(E,M);else if(A.mode===V.LINE_LOOP)_=new Le(E,M);else if(A.mode===V.POINTS)_=new ze(E,M);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+A.mode);Object.keys(_.geometry.morphAttributes).length>0&&Ki(_,h),_.name=i.createUniqueName(h.name||"mesh_"+s),q(_,h),A.extensions&&it(o,_,A),i.assignFinalMaterial(_),f.push(_)}for(let x=0,R=f.length;x<R;x++)i.associations.set(f[x],{meshes:s,primitives:x});if(f.length===1)return h.extensions&&it(o,f[0],h),f[0];const g=new bt;h.extensions&&it(o,g,h),i.associations.set(g,{meshes:s});for(let x=0,R=f.length;x<R;x++)g.add(f[x]);return g})}loadCamera(s){let i;const c=this.json.cameras[s],o=c[c.type];if(!o){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return c.type==="perspective"?i=new Jt(Ue.radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):c.type==="orthographic"&&(i=new Ce(-o.xmag,o.xmag,o.ymag,-o.ymag,o.znear,o.zfar)),c.name&&(i.name=this.createUniqueName(c.name)),q(i,c),Promise.resolve(i)}loadSkin(s){const i=this.json.skins[s],c=[];for(let o=0,h=i.joints.length;o<h;o++)c.push(this._loadNodeShallow(i.joints[o]));return i.inverseBindMatrices!==void 0?c.push(this.getDependency("accessor",i.inverseBindMatrices)):c.push(null),Promise.all(c).then(function(o){const h=o.pop(),a=o,l=[],u=[];for(let p=0,m=a.length;p<m;p++){const f=a[p];if(f){l.push(f);const g=new At;h!==null&&g.fromArray(h.array,p*16),u.push(g)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',i.joints[p])}return new Oe(l,u)})}loadAnimation(s){const i=this.json,c=this,o=i.animations[s],h=o.name?o.name:"animation_"+s,a=[],l=[],u=[],p=[],m=[];for(let f=0,g=o.channels.length;f<g;f++){const x=o.channels[f],R=o.samplers[x.sampler],E=x.target,A=E.node,_=o.parameters!==void 0?o.parameters[R.input]:R.input,M=o.parameters!==void 0?o.parameters[R.output]:R.output;E.node!==void 0&&(a.push(this.getDependency("node",A)),l.push(this.getDependency("accessor",_)),u.push(this.getDependency("accessor",M)),p.push(R),m.push(E))}return Promise.all([Promise.all(a),Promise.all(l),Promise.all(u),Promise.all(p),Promise.all(m)]).then(function(f){const g=f[0],x=f[1],R=f[2],E=f[3],A=f[4],_=[];for(let M=0,P=g.length;M<P;M++){const L=g[M],D=x[M],I=R[M],w=E[M],U=A[M];if(L===void 0)continue;L.updateMatrix&&L.updateMatrix();const O=c._createAnimationTracks(L,D,I,w,U);if(O)for(let j=0;j<O.length;j++)_.push(O[j])}return new De(h,void 0,_)})}createNodeMesh(s){const i=this.json,c=this,o=i.nodes[s];return o.mesh===void 0?null:c.getDependency("mesh",o.mesh).then(function(h){const a=c._getNodeRef(c.meshCache,o.mesh,h);return o.weights!==void 0&&a.traverse(function(l){if(l.isMesh)for(let u=0,p=o.weights.length;u<p;u++)l.morphTargetInfluences[u]=o.weights[u]}),a})}loadNode(s){const i=this.json,c=this,o=i.nodes[s],h=c._loadNodeShallow(s),a=[],l=o.children||[];for(let p=0,m=l.length;p<m;p++)a.push(c.getDependency("node",l[p]));const u=o.skin===void 0?Promise.resolve(null):c.getDependency("skin",o.skin);return Promise.all([h,Promise.all(a),u]).then(function(p){const m=p[0],f=p[1],g=p[2];g!==null&&m.traverse(function(x){x.isSkinnedMesh&&x.bind(g,Zi)});for(let x=0,R=f.length;x<R;x++)m.add(f[x]);return m})}_loadNodeShallow(s){const i=this.json,c=this.extensions,o=this;if(this.nodeCache[s]!==void 0)return this.nodeCache[s];const h=i.nodes[s],a=h.name?o.createUniqueName(h.name):"",l=[],u=o._invokeOne(function(p){return p.createNodeMesh&&p.createNodeMesh(s)});return u&&l.push(u),h.camera!==void 0&&l.push(o.getDependency("camera",h.camera).then(function(p){return o._getNodeRef(o.cameraCache,h.camera,p)})),o._invokeAll(function(p){return p.createNodeAttachment&&p.createNodeAttachment(s)}).forEach(function(p){l.push(p)}),this.nodeCache[s]=Promise.all(l).then(function(p){let m;if(h.isBone===!0?m=new Be:p.length>1?m=new bt:p.length===1?m=p[0]:m=new Xt,m!==p[0])for(let f=0,g=p.length;f<g;f++)m.add(p[f]);if(h.name&&(m.userData.name=h.name,m.name=a),q(m,h),h.extensions&&it(c,m,h),h.matrix!==void 0){const f=new At;f.fromArray(h.matrix),m.applyMatrix4(f)}else h.translation!==void 0&&m.position.fromArray(h.translation),h.rotation!==void 0&&m.quaternion.fromArray(h.rotation),h.scale!==void 0&&m.scale.fromArray(h.scale);return o.associations.has(m)||o.associations.set(m,{}),o.associations.get(m).nodes=s,m}),this.nodeCache[s]}loadScene(s){const i=this.extensions,c=this.json.scenes[s],o=this,h=new bt;c.name&&(h.name=o.createUniqueName(c.name)),q(h,c),c.extensions&&it(i,h,c);const a=c.nodes||[],l=[];for(let u=0,p=a.length;u<p;u++)l.push(o.getDependency("node",a[u]));return Promise.all(l).then(function(u){for(let m=0,f=u.length;m<f;m++)h.add(u[m]);const p=m=>{const f=new Map;for(const[g,x]of o.associations)(g instanceof St||g instanceof ie)&&f.set(g,x);return m.traverse(g=>{const x=o.associations.get(g);x!=null&&f.set(g,x)}),f};return o.associations=p(h),h})}_createAnimationTracks(s,i,c,o,h){const a=[],l=s.name?s.name:s.uuid,u=[];X[h.path]===X.weights?s.traverse(function(g){g.morphTargetInfluences&&u.push(g.name?g.name:g.uuid)}):u.push(l);let p;switch(X[h.path]){case X.weights:p=ne;break;case X.rotation:p=re;break;case X.position:case X.scale:p=se;break;default:switch(c.itemSize){case 1:p=ne;break;case 2:case 3:default:p=se;break}break}const m=o.interpolation!==void 0?ki[o.interpolation]:$t,f=this._getArrayFromAccessor(c);for(let g=0,x=u.length;g<x;g++){const R=new p(u[g]+"."+X[h.path],i.array,f,m);o.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(R),a.push(R)}return a}_getArrayFromAccessor(s){let i=s.array;if(s.normalized){const c=Ut(i.constructor),o=new Float32Array(i.length);for(let h=0,a=i.length;h<a;h++)o[h]=i[h]*c;i=o}return i}_createCubicSplineTrackInterpolant(s){s.createInterpolant=function(i){const c=this instanceof re?Fi:he;return new c(this.times,this.values,this.getValueSize()/3,i)},s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Yi(v,s,i){const c=s.attributes,o=new Qe;if(c.POSITION!==void 0){const l=i.json.accessors[c.POSITION],u=l.min,p=l.max;if(u!==void 0&&p!==void 0){if(o.set(new st(u[0],u[1],u[2]),new st(p[0],p[1],p[2])),l.normalized){const m=Ut(nt[l.componentType]);o.min.multiplyScalar(m),o.max.multiplyScalar(m)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const h=s.targets;if(h!==void 0){const l=new st,u=new st;for(let p=0,m=h.length;p<m;p++){const f=h[p];if(f.POSITION!==void 0){const g=i.json.accessors[f.POSITION],x=g.min,R=g.max;if(x!==void 0&&R!==void 0){if(u.setX(Math.max(Math.abs(x[0]),Math.abs(R[0]))),u.setY(Math.max(Math.abs(x[1]),Math.abs(R[1]))),u.setZ(Math.max(Math.abs(x[2]),Math.abs(R[2]))),g.normalized){const E=Ut(nt[g.componentType]);u.multiplyScalar(E)}l.max(u)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(l)}v.boundingBox=o;const a=new Ye;o.getCenter(a.center),a.radius=o.min.distanceTo(o.max)/2,v.boundingSphere=a}function ue(v,s,i){const c=s.attributes,o=[];function h(a,l){return i.getDependency("accessor",a).then(function(u){v.setAttribute(l,u)})}for(const a in c){const l=It[a]||a.toLowerCase();l in v.attributes||o.push(h(c[a],l))}if(s.indices!==void 0&&!v.index){const a=i.getDependency("accessor",s.indices).then(function(l){v.setIndex(l)});o.push(a)}return te.workingColorSpace!==K&&"COLOR_0"in c&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${te.workingColorSpace}" not supported.`),q(v,s),Yi(v,s,i),Promise.all(o).then(function(){return s.targets!==void 0?ji(v,s.targets,i):v})}var de={exports:{}};const Wi=ri(Je);/*!
* three.proton v0.2.0
* https://github.com/drawcall/three.proton
*
* Copyright 2011-2020, ajiemath
* Licensed under the MIT license
* http://www.opensource.org/licenses/mit-license
*
*/(function(v,s){(function(i,c){v.exports=c(Wi)})(oi,function(i){function c(t,e,n,d){c._super_.call(this),this.camera=t,this.renderer=e,this.dis=n||20,d=d||"1234";for(var y=1;y<5;y++)this["d"+y]=d.indexOf(y+"")>=0;this.name="ScreenZone"}function o(t,e,n,N,y,T){var S,C,H,F,k,N;o._super_.call(this),r.Util.isUndefined(e,n,N,y,T)?(S=C=H=0,F=k=N=t||100):r.Util.isUndefined(N,y,T)?(S=C=H=0,F=t,k=e,N=n):(S=t,C=e,H=n,F=N,k=y,N=T),this.x=S,this.y=C,this.z=H,this.width=F,this.height=k,this.depth=N,this.friction=.85,this.max=6}function h(t,e,n){var d,y,T;h._super_.call(this),r.Util.isUndefined(t,e,n)?d=y=T=0:(d=t,y=e,T=n),this.x=d,this.y=y,this.z=T}function a(t,e){a._super_.call(this),t instanceof i.Geometry?this.geometry=t:this.geometry=t.geometry,this.scale=e||1}function l(t,e,n,d){var y,T;l._super_.call(this),r.Util.isUndefined(e,n,d)?(y=0,T=t||100):(y=t,T=d),this.x=y,this.y=y,this.z=y,this.radius=T,this.tha=this.phi=0}function u(t,e,n,d,y,T){u._super_.call(this),t instanceof r.Vector3D?(this.x1=t.x,this.y1=t.y,this.z1=t.z,this.x2=d.x,this.y2=d.y,this.z2=d.z):(this.x1=t,this.y1=e,this.z1=n,this.x2=d,this.y2=y,this.z2=T)}function p(){this.vector=new r.Vector3D(0,0,0),this.random=0,this.crossType="dead",this.log=!0}function m(){m._super_.call(this),this.targetPool=new r.Pool,this.materialPool=new r.Pool,this.name="CustomRender"}function f(t){f._super_.call(this,t),this._body=new i.Sprite(new i.SpriteMaterial({color:16777215})),this.name="SpriteRender"}function g(t){g._super_.call(this),this.points=t,this.name="PointsRender"}function x(t){x._super_.call(this),this.container=t,this._targetPool=new r.Pool,this._materialPool=new r.Pool,this._body=new i.Mesh(new i.BoxGeometry(50,50,50),new i.MeshLambertMaterial({color:"#ff0000"})),this.name="MeshRender"}function R(){this.name="BaseRender"}function E(t,e,n){this.mouseTarget=r.Util.initValue(t,window),this.ease=r.Util.initValue(e,.7),this._allowEmitting=!1,this.mouse=new r.Vector3D,this.initEventHandler(),E._super_.call(this,n)}function A(t){this.selfBehaviours=[],A._super_.call(this,t)}function _(t){this.initializes=[],this.particles=[],this.behaviours=[],this.currentEmitTime=0,this.totalEmitTimes=-1,this.damping=.006,this.bindEmitter=!0,this.rate=new r.Rate(1,.1),_._super_.call(this,t),this.id="emitter_"+_.ID++,this.cID=0,this.name="Emitter"}function M(t,e,n,d,y,T,S){M._super_.call(this,T,S),M.prototype.reset(t,e,n,d,y),this.name="Spring"}function P(t,e,n,d){P._super_.call(this,n,d),this.reset(t,e),this.name="Color"}function L(t,e,n,d,y){L._super_.call(this,d,y),this.reset(t,e,n),this.name="Rotate"}function D(t,e,n,d){D._super_.call(this,n,d),this.reset(t,e),this.name="Scale"}function I(t,e,n,d){I._super_.call(this,n,d),this.reset(t,e),this.name="Alpha"}function w(t,e,n,d){w._super_.call(this,n,d),this.reset(t,e),this.name="CrossZone"}function U(t,e,n,d,y){U._super_.call(this,d,y),this.reset(t,e,n),this.name="Collision"}function O(t,e,n){O._super_.call(this,0,-t,0,e,n),this.name="Gravity"}function j(t,e,n,d,y){j._super_.call(this,t,e,n,d,y),this.force*=-1,this.name="Repulsion"}function Z(t,e,n,d,y,T){Z._super_.call(this,y,T),this.reset(t,e,n,d),this.time=0,this.name="RandomDrift"}function Q(t,e,n,d,y){Q._super_.call(this,d,y),this.targetPosition=r.Util.initValue(t,new r.Vector3D),this.radius=r.Util.initValue(n,1e3),this.force=r.Util.initValue(this.normalizeValue(e),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new r.Vector3D,this.lengthSq=0,this.name="Attraction"}function Y(t,e,n,d,y){Y._super_.call(this,d,y),Y.prototype.reset.call(this,t,e,n),this.name="Force"}function dt(t,e,n){dt._super_.call(this),this.body=r.createArraySpan(t),this.w=e,this.h=r.Util.initValue(n,this.w)}function rt(t,e,n){rt._super_.call(this),this.radius=r.createSpan(t,e,n)}function pt(t,e,n){pt._super_.call(this),this.massPan=r.createSpan(t,e,n)}function W(t,e,n){W._super_.call(this),this.reset(t,e,n),this.dirVec=new r.Vector3D(0,0,0),this.name="Velocity"}function J(){J._super_.call(this),this.reset.apply(this,arguments)}function ft(t,e,n){ft._super_.call(this),this.lifePan=r.createSpan(t,e,n)}function mt(){this.name="Initialize"}function Ct(t,e){this.numPan=r.createSpan(r.Util.initValue(t,1)),this.timePan=r.createSpan(r.Util.initValue(e,1)),this.startTime=0,this.nextTime=0,this.init()}function yt(t,e){this.id="Behaviour_"+yt.id++,this.life=r.Util.initValue(t,1/0),this.easing=r.Util.initValue(e,r.ease.setEasingByName(r.ease.easeLinear)),this.age=0,this.energy=1,this.dead=!1,this.name="Behaviour"}function Ot(t,e,n,d,y,T){this.x=t,this.y=e,this.z=n,this.width=d,this.height=y,this.depth=T,this.bottom=this.y+this.height,this.right=this.x+this.width,this.right=this.x+this.width}function _t(t){this._arr=r.Util.isArray(t)?t:[t]}function $(t,e,n){this._isArray=!1,r.Util.isArray(t)?(this._isArray=!0,this.a=t):(this.a=r.Util.initValue(t,1),this.b=r.Util.initValue(e,this.a),this._center=r.Util.initValue(n,!1))}function Dt(){this.cID=0,this.list={}}function gt(t){this.id="particle_"+gt.ID++,this.name="Particle",this.reset("init"),r.Util.setPrototypeByObj(this,t)}function vt(){this.initialize()}function r(t,e){this.preParticles=r.Util.initValue(t,r.POOL_MAX),this.integrationType=r.Util.initValue(e,r.EULER),this.emitters=[],this.renderers=[],this.pool=new r.Pool,r.integrator=new r.Integration(this.integrationType)}r.POOL_MAX=500,r.TIME_STEP=60,r.PI=3.142,r.DR=r.PI/180,r.MEASURE=100,r.EULER="euler",r.RK2="runge-kutta2",r.RK4="runge-kutta4",r.VERLET="verlet",r.PARTICLE_CREATED="partilcleCreated",r.PARTICLE_UPDATE="partilcleUpdate",r.PARTICLE_SLEEP="particleSleep",r.PARTICLE_DEAD="partilcleDead",r.PROTON_UPDATE="protonUpdate",r.PROTON_UPDATE_AFTER="protonUpdateAfter",r.EMITTER_ADDED="emitterAdded",r.EMITTER_REMOVED="emitterRemoved",r.bindEmtterEvent=!1,r.prototype={addRender:function(t){this.renderers.push(t),t.init(this)},removeRender:function(t){this.renderers.splice(this.renderers.indexOf(t),1),t.remove(this)},addEmitter:function(t){this.emitters.push(t),t.parent=this,this.dispatchEvent("EMITTER_ADDED",t)},removeEmitter:function(t){t.parent==this&&(this.emitters.splice(this.emitters.indexOf(t),1),t.parent=null,this.dispatchEvent("EMITTER_REMOVED",t))},update:function(t){this.dispatchEvent("PROTON_UPDATE",this);var e=t||.0167;if(e>0)for(var n=this.emitters.length;n--;)this.emitters[n].update(e);this.dispatchEvent("PROTON_UPDATE_AFTER",this)},getCount:function(){var t=0,e,n=this.emitters.length;for(e=0;e<n;e++)t+=this.emitters[e].particles.length;return t},destroy:function(){var t=0,e=this.emitters.length;for(t;t<e;t++)this.emitters[t].destroy(),delete this.emitters[t];this.emitters.length=0,this.pool.destroy()}},vt.initialize=function(t){t.addEventListener=B.addEventListener,t.removeEventListener=B.removeEventListener,t.removeAllEventListeners=B.removeAllEventListeners,t.hasEventListener=B.hasEventListener,t.dispatchEvent=B.dispatchEvent};var B=vt.prototype;B._listeners=null,B.initialize=function(){},B.addEventListener=function(t,e){return this._listeners?this.removeEventListener(t,e):this._listeners={},this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e),e},B.removeEventListener=function(t,e){if(this._listeners){if(!this._listeners[t])return;for(var n=this._listeners[t],d=0,y=n.length;d<y;d++)if(n[d]==e){y==1?delete this._listeners[t]:n.splice(d,1);break}}},B.removeAllEventListeners=function(t){t?this._listeners&&delete this._listeners[t]:this._listeners=null},B.dispatchEvent=function(t,e){var n=!1,d=this._listeners;if(t&&d){var y=d[t];if(!y)return n;y=y.slice();for(var T,S=y.length;S--;){var T=y[S];n=n||T(e)}}return!!n},B.hasEventListener=function(t){var e=this._listeners;return!!e&&!!e[t]},vt.initialize(r.prototype),r.EventDispatcher=vt;var xt=xt||{initValue:function(n,e){var n=n!=null&&n!=null?n:e;return n},isArray:function(t){return Object.prototype.toString.call(t)==="[object Array]"},destroyArray:function(t){t.length=0},destroyObject:function(t){for(var e in t)delete t[e]},isUndefined:function(){for(var t in arguments){var e=arguments[t];if(e!==void 0)return!1}return!0},setVectorByObj:function(t,e){e.x!==void 0&&(t.p.x=e.x),e.y!==void 0&&(t.p.y=e.y),e.z!==void 0&&(t.p.z=e.z),e.vx!==void 0&&(t.v.x=e.vx),e.vy!==void 0&&(t.v.y=e.vy),e.vz!==void 0&&(t.v.z=e.vz),e.ax!==void 0&&(t.a.x=e.ax),e.ay!==void 0&&(t.a.y=e.ay),e.az!==void 0&&(t.a.z=e.az),e.p!==void 0&&t.p.copy(e.p),e.v!==void 0&&t.v.copy(e.v),e.a!==void 0&&t.a.copy(e.a),e.position!==void 0&&t.p.copy(e.position),e.velocity!==void 0&&t.v.copy(e.velocity),e.accelerate!==void 0&&t.a.copy(e.accelerate)},setPrototypeByObj:function(t,e,n){for(var d in e)t.hasOwnProperty(d)&&(n?n.indexOf(d)<0&&(t[d]=xt._getValue(e[d])):t[d]=xt._getValue(e[d]));return t},_getValue:function(t){return t instanceof $?t.getValue():t},inherits:function(t,e){if(t._super_=e,Object.create)t.prototype=Object.create(e.prototype,{constructor:{value:t}});else{var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}};r.Util=xt;var Bt=Bt||{getRGB:function(t){var e={};if(typeof t=="number")d=Math.floor(t),e.r=(t>>16&255)/255,e.g=(t>>8&255)/255,e.b=(t&255)/255;else if(typeof t=="string"){var n;if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(t))e.r=Math.min(255,parseInt(n[1],10))/255,e.g=Math.min(255,parseInt(n[2],10))/255,e.b=Math.min(255,parseInt(n[3],10))/255;else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var d=n[1];e.r=parseInt(d.charAt(0)+d.charAt(1),16)/255,e.g=parseInt(d.charAt(2)+d.charAt(3),16)/255,e.b=parseInt(d.charAt(4)+d.charAt(5),16)/255}}else t instanceof i.Color&&(e.r=t.r,e.g=t.g,e.b=t.b);return e}};r.ColorUtil=Bt;var pe={toScreenPos:function(){var t=new i.Vector3;return function(e,n,d){return t.copy(e),t.project(n),t.x=Math.round((t.x+1)*d.width/2),t.y=Math.round((-t.y+1)*d.height/2),t.z=0,t}}(),toSpacePos:function(){var t=new i.Vector3,e=new i.Vector3,n;return function(d,y,T){return t.set(d.x/T.width*2-1,-(d.y/T.height)*2+1,.5),t.unproject(y),e.copy(t.sub(y.position).normalize()),n=-y.position.z/e.z,t.copy(y.position),t.add(e.multiplyScalar(n)),t}}(),getTexture:function(){var t={};return function(e){if(e instanceof i.Texture)return e;if(typeof e=="string"){var n=r.PUID.hash(e);return t[n]||(t[n]=new i.Texture(e)),t[n]}if(e instanceof Image){var n=r.PUID.hash(e.src);return t[n]||(t[n]=new i.Texture(e)),t[n]}}}()};r.THREEUtil=pe;var Nt=Nt||{_id:0,_uids:{},id:function(t){for(var e in this._uids)if(this._uids[e]==t)return e;var n="PUID_"+this._id++;return this._uids[n]=t,n},hash:function(t){}};r.PUID=Nt,gt.ID=0,gt.prototype={getDirection:function(){return Math.atan2(this.v.x,-this.v.y)*(180/r.PI)},reset:function(t){return this.life=1/0,this.age=0,this.energy=1,this.dead=!1,this.sleep=!1,this.body=null,this.parent=null,this.mass=1,this.radius=10,this.alpha=1,this.scale=1,this.useColor=!1,this.useAlpha=!1,this.easing=r.ease.setEasingByName(r.ease.easeLinear),t?(this.p=new r.Vector3D,this.v=new r.Vector3D,this.a=new r.Vector3D,this.old={},this.old.p=this.p.clone(),this.old.v=this.v.clone(),this.old.a=this.a.clone(),this.behaviours=[],this.transform={},this.color={r:0,g:0,b:0},this.rotation=new r.Vector3D):(this.p.set(0,0,0),this.v.set(0,0,0),this.a.set(0,0,0),this.old.p.set(0,0,0),this.old.v.set(0,0,0),this.old.a.set(0,0,0),this.color.r=0,this.color.g=0,this.color.b=0,this.rotation.clear(),r.Util.destroyObject(this.transform),this.removeAllBehaviours()),this},update:function(t,e){if(!this.sleep){this.age+=t;for(var n=this.behaviours.length;n--;)this.behaviours[n]&&this.behaviours[n].applyBehaviour(this,t,e)}if(this.age>=this.life)this.destroy();else{var d=this.easing(this.age/this.life);this.energy=Math.max(1-d,0)}},addBehaviour:function(t){this.behaviours.push(t),t.initialize(this)},addBehaviours:function(t){for(var e=t.length;e--;)this.addBehaviour(t[e])},removeBehaviour:function(t){var e=this.behaviours.indexOf(t);e>-1&&this.behaviours.splice(e,1)},removeAllBehaviours:function(){r.Util.destroyArray(this.behaviours)},destroy:function(){this.removeAllBehaviours(),this.energy=0,this.dead=!0,this.parent=null}},r.Particle=gt,Dt.prototype={create:function(t){return this.cID++,typeof t=="function"?new t:t.clone()},getCount:function(){var t=0;for(var e in this.list)t+=this.list[e].length;return t++},get:function(t){var e,n=t.__puid||r.PUID.id(t);return this.list[n]&&this.list[n].length>0?e=this.list[n].pop():e=this.create(t),e.__puid=t.__puid||n,e},expire:function(t){return this._getList(t.__puid).push(t)},destroy:function(){for(var t in this.list)this.list[t].length=0,delete this.list[t]},_getList:function(t){return t=t||"default",this.list[t]||(this.list[t]=[]),this.list[t]}},r.Pool=Dt;var Vt={randomAToB:function(t,e,n){return n?(Math.random()*(e-t)>>0)+t:t+Math.random()*(e-t)},randomFloating:function(t,e,n){return Vt.randomAToB(t-e,t+e,n)},randomZone:function(t){},degreeTransform:function(t){return t*r.PI/180},toColor16:function(t){return"#"+t.toString(16)},randomColor:function(){return"#"+("00000"+(Math.random()*16777216<<0).toString(16)).slice(-6)},lerp:function(t,e,n){return e+(t-e)*n},getNormal:function(t,e){return t.x==0&&t.y==0?t.z==0?e.set(1,0,1):e.set(1,1,-t.y/t.z):t.x==0?e.set(1,0,1):e.set(-t.y/t.x,1,1),e.normalize()},axisRotate:function(t,e,n,d){var y=Math.cos(d),T=Math.sin(d),S=n.dot(e)*(1-y);t.copy(n),t.cross(e).scalar(T),t.addValue(e.x*y,e.y*y,e.z*y),t.addValue(n.x*S,n.y*S,n.z*S)}};r.MathUtils=Vt;var Ht=function(t){this.type=r.Util.initValue(t,r.EULER)};Ht.prototype={integrate:function(t,e,n){this.euler(t,e,n)},euler:function(t,e,n){t.sleep||(t.old.p.copy(t.p),t.old.v.copy(t.v),t.a.scalar(1/t.mass),t.v.add(t.a.scalar(e)),t.p.add(t.old.v.scalar(e)),n&&t.v.scalar(n),t.a.clear())}},r.Integration=Ht;var Ft=function(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0};Ft.prototype={set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},getGradient:function(){if(this.x!=0)return Math.atan2(this.y,this.x);if(this.y>0)return r.PI/2;if(this.y<0)return-r.PI/2},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return e!==void 0?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addValue:function(t,e,n){return this.x+=t,this.y+=e,this.z+=n,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},sub:function(t,e){return e!==void 0?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},scalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},divideScalar:function(t){return t!==0?(this.x/=t,this.y/=t,this.z/=t):this.set(0,0,0),this},negate:function(){return this.scalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){var e=this.x,n=this.y,d=this.z;return this.x=n*t.z-d*t.y,this.y=d*t.x-e*t.z,this.z=e*t.y-n*t.x,this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},crossVectors:function(t,e){var n=t.x,d=t.y,y=t.z,T=e.x,S=e.y,C=e.z;return this.x=d*C-y*S,this.y=y*T-n*C,this.z=n*S-d*T,this},eulerFromDir:function(t){},applyEuler:function(){var t;return function(e){return t===void 0&&(t=new r.Quaternion),this.applyQuaternion(t.setFromEuler(e)),this}}(),applyAxisAngle:function(){var t;return function(e,n){return t===void 0&&(t=new r.Quaternion),this.applyQuaternion(t.setFromAxisAngle(e,n)),this}}(),applyQuaternion:function(t){var e=this.x,n=this.y,d=this.z,y=t.x,T=t.y,S=t.z,C=t.w,H=C*e+T*d-S*n,F=C*n+S*e-y*d,k=C*d+y*n-T*e,N=-y*e-T*n-S*d;return this.x=H*C+N*-y+F*-S-k*-T,this.y=F*C+N*-T+k*-y-H*-S,this.z=k*C+N*-S+H*-T-F*-y,this},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,d=this.z-t.z;return e*e+n*n+d*d},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},clear:function(){return this.x=0,this.y=0,this.z=0,this},clone:function(){return new r.Vector3D(this.x,this.y,this.z)},toString:function(){return"x:"+this.x+"y:"+this.y+"z:"+this.z}},r.Vector3D=Ft;var Tt=function(t,e,n){this.radius=t||1,this.phi=n||0,this.theta=e||0};Tt.prototype={set:function(t,e,n){return this.radius=t||1,this.phi=n||0,this.theta=e||0,this},setRadius:function(t){return this.radius=t,this},setPhi:function(t){return this.phi=t,this},setTheta:function(t){return this.theta=t,this},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},toVector3D:function(){return new r.Vector3D(this.getX(),this.getY(),this.getZ())},getX:function(){return this.radius*Math.sin(this.theta)*Math.cos(this.phi)},getY:function(){return-this.radius*Math.sin(this.theta)*Math.sin(this.phi)},getZ:function(){return this.radius*Math.cos(this.theta)},normalize:function(){return this.radius=1,this},equals:function(t){return t.radius===this.radius&&t.phi===this.phi&&t.theta===this.theta},clear:function(){return this.radius=0,this.phi=0,this.theta=0,this},clone:function(){return new Tt(this.radius,this.phi,this.theta)}},r.Polar3D=Tt,$.prototype={getValue:function(t){return this._isArray?this.a[this.a.length*Math.random()>>0]:this._center?r.MathUtils.randomFloating(this.a,this.b,t):r.MathUtils.randomAToB(this.a,this.b,t)}},r.createSpan=function(t,e,n){return t instanceof $?t:e===void 0?new $(t):n===void 0?new $(t,e):new $(t,e,n)},r.Span=$,r.Util.inherits(_t,r.Span),_t.prototype.getValue=function(){var t=this._arr[this._arr.length*Math.random()>>0];return t=="random"||t=="Random"?r.MathUtils.randomColor():t},r.createArraySpan=function(t){return t?t instanceof r.ArraySpan?t:new r.ArraySpan(t):null},r.ArraySpan=_t;var kt=function(t,e,n,d){this.x=t||0,this.y=e||0,this.z=n||0,this.w=d!==void 0?d:1};kt.prototype={set:function(t,e,n,d){return this.x=t,this.y=e,this.z=n,this.w=d,this},clone:function(){return new r.Quaternion(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},setFromEuler:function(t){var e=Math.cos(t.x/2),n=Math.cos(t.y/2),d=Math.cos(t.z/2),y=Math.sin(t.x/2),T=Math.sin(t.y/2),S=Math.sin(t.z/2);return this.x=y*n*d+e*T*S,this.y=e*T*d-y*n*S,this.z=e*n*S+y*T*d,this.w=e*n*d-y*T*S,this},setFromAxisAngle:function(t,e){var n=e/2,d=Math.sin(n);return this.x=t.x*d,this.y=t.y*d,this.z=t.z*d,this.w=Math.cos(n),this},normalize:function(){var t=this.length();return t===0?(this.x=0,this.y=0,this.z=0,this.w=1):(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}},r.Quaternion=kt,Ot.prototype={contains:function(t,e,n){return t<=this.right&&t>=this.x&&e<=this.bottom&&e>=this.y&&n<=this.depth&&n>=this.z}},r.Box=Ot,yt.id=0,yt.prototype={reset:function(t,e){this.life=r.Util.initValue(t,1/0),this.easing=r.Util.initValue(e,r.ease.setEasingByName(r.ease.easeLinear))},normalizeForce:function(t){return t.scalar(r.MEASURE)},normalizeValue:function(t){return t*r.MEASURE},initialize:function(t){},applyBehaviour:function(t,e,n){if(!this.dead){if(this.age+=e,this.age>=this.life){this.energy=0,this.dead=!0;return}var d=this.easing(t.age/t.life);this.energy=Math.max(1-d,0)}},destroy:function(){}},r.Behaviour=yt,Ct.prototype={init:function(){this.startTime=0,this.nextTime=this.timePan.getValue()},getValue:function(t){return this.startTime+=t,this.startTime>=this.nextTime?(this.init(),this.numPan.b==1?this.numPan.getValue("Float")>.5?1:0:this.numPan.getValue("Int")):0}},r.Rate=Ct,mt.prototype.reset=function(){},mt.prototype.init=function(t,e){e?this.initialize(e):this.initialize(t)},mt.prototype.initialize=function(t){},r.Initialize=mt;var Et={initialize:function(t,e,n){for(var d=n.length;d--;){var y=n[d];y instanceof r.Initialize?y.init(t,e):Et.init(t,e,y)}Et.bindEmitter(t,e)},init:function(t,e,n){r.Util.setPrototypeByObj(e,n),r.Util.setVectorByObj(e,n)},bindEmitter:function(t,e){t.bindEmitter&&(e.p.add(t.p),e.v.add(t.v),e.a.add(t.a),e.v.applyEuler(t.rotation))}};r.InitializeUtil=Et,r.Util.inherits(ft,r.Initialize),ft.prototype.initialize=function(t){this.lifePan.a==1/0||this.lifePan.a=="infi"?t.life=1/0:t.life=this.lifePan.getValue()},r.Life=ft,r.Util.inherits(J,r.Initialize),J.prototype.reset=function(){this.zones?this.zones.length=0:this.zones=[];var t=Array.prototype.slice.call(arguments);this.zones=this.zones.concat(t)},J.prototype.addZone=function(){var t=Array.prototype.slice.call(arguments);this.zones=this.zones.concat(t)},J.prototype.initialize=function(){return function(t){var e=this.zones[Math.random()*this.zones.length>>0];e.getPosition(),t.p.x=e.vector.x,t.p.y=e.vector.y,t.p.z=e.vector.z}}(),r.Position=J,r.P=J,r.Util.inherits(W,r.Initialize),W.prototype.reset=function(t,e,n){t instanceof r.Vector3D?(this.radiusPan=r.createSpan(1),this.dir=t.clone(),this.tha=e*r.DR,this._useV=!0):t instanceof r.Polar3D?(this.tha=e*r.DR,this.dirVec=t.toVector3D(),this._useV=!1):(this.radiusPan=r.createSpan(t),this.dir=e.clone().normalize(),this.tha=n*r.DR,this._useV=!0)},W.prototype.normalize=function(t){return t*r.MEASURE},W.prototype.initialize=function(){var t,e=new r.Vector3D(0,0,1),n=new r.Vector3D(0,0,0);return function(d){return t=this.tha*Math.random(),this._useV&&this.dirVec.copy(this.dir).scalar(this.radiusPan.getValue()),r.MathUtils.getNormal(this.dirVec,e),n.copy(this.dirVec).applyAxisAngle(e,t),n.applyAxisAngle(this.dirVec.normalize(),Math.random()*r.PI*2),d.v.copy(n),this}}(),r.Velocity=W,r.V=W,r.Util.inherits(pt,r.Initialize),pt.prototype.initialize=function(t){t.mass=this.massPan.getValue()},r.Mass=pt,r.Util.inherits(rt,r.Initialize),rt.prototype.reset=function(t,e,n){this.radius=r.createSpan(t,e,n)},rt.prototype.initialize=function(t){t.radius=this.radius.getValue(),t.transform.oldRadius=t.radius},r.Radius=rt,r.Util.inherits(dt,r.Initialize),dt.prototype.initialize=function(t){var e=this.body.getValue();this.w?t.body={width:this.w,height:this.h,body:e}:t.body=e},r.Body=dt,r.Util.inherits(Y,r.Behaviour),Y.prototype.reset=function(t,e,n){this.force=this.normalizeForce(new r.Vector3D(t,e,n)),this.force.id=Math.random()},Y.prototype.applyBehaviour=function(t,e,n){Y._super_.prototype.applyBehaviour.call(this,t,e,n),t.a.add(this.force)},r.F=r.Force=Y,r.Util.inherits(Q,r.Behaviour),Q.prototype.reset=function(t,e,n,d,y){this.targetPosition=r.Util.initValue(t,new r.Vector3D),this.radius=r.Util.initValue(n,1e3),this.force=r.Util.initValue(this.normalizeValue(e),100),this.radiusSq=this.radius*this.radius,this.attractionForce=new r.Vector3D,this.lengthSq=0,d&&Q._super_.prototype.reset.call(this,d,y)},Q.prototype.applyBehaviour=function(t,e,n){Q._super_.prototype.applyBehaviour.call(this,t,e,n),this.attractionForce.copy(this.targetPosition),this.attractionForce.sub(t.p),this.lengthSq=this.attractionForce.lengthSq(),this.lengthSq>4e-6&&this.lengthSq<this.radiusSq&&(this.attractionForce.normalize(),this.attractionForce.scalar(1-this.lengthSq/this.radiusSq),this.attractionForce.scalar(this.force),t.a.add(this.attractionForce))},r.Attraction=Q,r.Util.inherits(Z,r.Behaviour),Z.prototype.reset=function(t,e,n,d,y,T){this.randomFoce=this.normalizeForce(new r.Vector3D(t,e,n)),this.delayPan=r.createSpan(d||.03),this.time=0,y&&Z._super_.prototype.reset.call(this,y,T)},Z.prototype.applyBehaviour=function(t,e,n){if(Z._super_.prototype.applyBehaviour.call(this,t,e,n),this.time+=e,this.time>=this.delayPan.getValue()){var d=r.MathUtils.randomAToB(-this.randomFoce.x,this.randomFoce.x),y=r.MathUtils.randomAToB(-this.randomFoce.y,this.randomFoce.y),T=r.MathUtils.randomAToB(-this.randomFoce.z,this.randomFoce.z);t.a.addValue(d,y,T),this.time=0}},r.RandomDrift=Z,r.Util.inherits(j,r.Attraction),j.prototype.reset=function(t,e,n,d,y){j._super_.prototype.reset.call(this,t,e,n,d,y),this.force*=-1},r.Repulsion=j,r.Util.inherits(O,r.Force),O.prototype.reset=function(t,e,n){O._super_.prototype.reset.call(this,0,-t,0,e,n)},r.Gravity=O,r.G=O,r.Util.inherits(U,r.Behaviour),U.prototype.reset=function(t,e,n,d,y){this.emitter=t,this.useMass=e,this.callback=n,this.particles=[],this.delta=new r.Vector3D,d&&U._super_.prototype.reset.call(this,d,y)},U.prototype.applyBehaviour=function(t,e,n){for(var d=this.emitter?this.emitter.particles.slice(n):this.particles.slice(n),y,T,S,C,H,F,k=d.length;k--;)y=d[k],y!=t&&(this.delta.copy(y.p).sub(t.p),T=this.delta.lengthSq(),C=t.radius+y.radius,T<=C*C&&(S=C-Math.sqrt(T),S+=.5,H=this._getAverageMass(t,y),F=this._getAverageMass(y,t),t.p.add(this.delta.clone().normalize().scalar(S*-H)),y.p.add(this.delta.normalize().scalar(S*F)),this.callback&&this.callback(t,y)))},U.prototype._getAverageMass=function(t,e){return this.useMass?e.mass/(t.mass+e.mass):.5},r.Collision=U,r.Util.inherits(w,r.Behaviour),w.prototype.reset=function(t,e,n,d){var y,T;typeof t=="string"?(T=t,y=e):(T=e,y=t),this.zone=y,this.zone.crossType=r.Util.initValue(T,"dead"),n&&w._super_.prototype.reset.call(this,n,d)},w.prototype.applyBehaviour=function(t,e,n){w._super_.prototype.applyBehaviour.call(this,t,e,n),this.zone.crossing.call(this.zone,t)},r.CrossZone=w,r.Util.inherits(I,r.Behaviour),I.prototype.reset=function(t,e,n,d){e==null||e==null?this._same=!0:this._same=!1,this.a=r.createSpan(r.Util.initValue(t,1)),this.b=r.createSpan(e),n&&I._super_.prototype.reset.call(this,n,d)},I.prototype.initialize=function(t){t.useAlpha=!0,t.transform.alphaA=this.a.getValue(),this._same?t.transform.alphaB=t.transform.alphaA:t.transform.alphaB=this.b.getValue()},I.prototype.applyBehaviour=function(t,e,n){I._super_.prototype.applyBehaviour.call(this,t,e,n),t.alpha=r.MathUtils.lerp(t.transform.alphaA,t.transform.alphaB,this.energy),t.alpha<.002&&(t.alpha=0)},r.Alpha=I,r.Util.inherits(D,r.Behaviour),D.prototype.reset=function(t,e,n,d){e==null||e==null?this._same=!0:this._same=!1,this.a=r.createSpan(r.Util.initValue(t,1)),this.b=r.createSpan(e),n&&D._super_.prototype.reset.call(this,n,d)},D.prototype.initialize=function(t){t.transform.scaleA=this.a.getValue(),t.transform.oldRadius=t.radius,this._same?t.transform.scaleB=t.transform.scaleA:t.transform.scaleB=this.b.getValue()},D.prototype.applyBehaviour=function(t,e,n){D._super_.prototype.applyBehaviour.call(this,t,e,n),t.scale=r.MathUtils.lerp(t.transform.scaleA,t.transform.scaleB,this.energy),t.scale<5e-4&&(t.scale=0),t.radius=t.transform.oldRadius*t.scale},r.Scale=D,r.Util.inherits(L,r.Behaviour),L.prototype.reset=function(t,e,n,d,y){this.a=t||0,this.b=e||0,this.c=n||0,t===void 0||t=="same"?this._type="same":e==null?this._type="set":n===void 0?this._type="to":(this._type="add",this.a=r.createSpan(this.a*r.DR),this.b=r.createSpan(this.b*r.DR),this.c=r.createSpan(this.c*r.DR)),d&&L._super_.prototype.reset.call(this,d,y)},L.prototype.initialize=function(t){switch(this._type){case"same":break;case"set":this._setRotation(t.rotation,this.a);break;case"to":t.transform.fR=t.transform.fR||new r.Vector3D,t.transform.tR=t.transform.tR||new r.Vector3D,this._setRotation(t.transform.fR,this.a),this._setRotation(t.transform.tR,this.b);break;case"add":t.transform.addR=new r.Vector3D(this.a.getValue(),this.b.getValue(),this.c.getValue())}},L.prototype._setRotation=function(t,e){if(t=t||new r.Vector3D,e=="random"){var n=r.MathUtils.randomAToB(-r.PI,r.PI),d=r.MathUtils.randomAToB(-r.PI,r.PI),y=r.MathUtils.randomAToB(-r.PI,r.PI);t.set(n,d,y)}else e instanceof r.Vector3D&&t.copy(e)},L.prototype.applyBehaviour=function(t,e,n){switch(L._super_.prototype.applyBehaviour.call(this,t,e,n),this._type){case"same":t.rotation||(t.rotation=new r.Vector3D),t.rotation.eulerFromDir(t.v);break;case"set":break;case"to":t.rotation.x=r.MathUtils.lerp(t.transform.fR.x,t.transform.tR.x,this.energy),t.rotation.y=r.MathUtils.lerp(t.transform.fR.y,t.transform.tR.y,this.energy),t.rotation.z=r.MathUtils.lerp(t.transform.fR.z,t.transform.tR.z,this.energy);break;case"add":t.rotation.add(t.transform.addR)}},r.Rotate=L,r.Util.inherits(P,r.Behaviour),P.prototype.reset=function(t,e,n,d){e==null||e==null?this._same=!0:this._same=!1,this.a=r.createArraySpan(t),this.b=r.createArraySpan(e),n&&P._super_.prototype.reset.call(this,n,d)},P.prototype.initialize=function(t){t.transform.colorA=r.ColorUtil.getRGB(this.a.getValue()),t.useColor=!0,this._same?t.transform.colorB=t.transform.colorA:t.transform.colorB=r.ColorUtil.getRGB(this.b.getValue())},P.prototype.applyBehaviour=function(t,e,n){P._super_.prototype.applyBehaviour.call(this,t,e,n),this._same?(t.color.r=t.transform.colorA.r,t.color.g=t.transform.colorA.g,t.color.b=t.transform.colorA.b):(t.color.r=r.MathUtils.lerp(t.transform.colorA.r,t.transform.colorB.r,this.energy),t.color.g=r.MathUtils.lerp(t.transform.colorA.g,t.transform.colorB.g,this.energy),t.color.b=r.MathUtils.lerp(t.transform.colorA.b,t.transform.colorB.b,this.energy))},r.Color=P,r.Util.inherits(M,r.Behaviour),M.prototype.reset=function(t,e,n,d,y){this.pos?this.pos.set(t,e,n):this.pos=new r.Vector3D(t,e,n),this.spring=d||.1,this.friction=y||.98},M.prototype.applyBehaviour=function(t,e,n){M._super_.prototype.applyBehaviour.call(this,t,e,n),t.v.x+=(this.pos.x-t.p.x)*this.spring,t.v.y+=(this.pos.y-t.p.y)*this.spring,t.v.z+=(this.pos.z-t.p.z)*this.spring},r.Spring=M,_.ID=0,r.Util.inherits(_,r.Particle),r.EventDispatcher.initialize(_.prototype),_.prototype.emit=function(t,e){this.currentEmitTime=0,this.totalEmitTimes=r.Util.initValue(t,1/0),e==!0||e=="life"||e=="destroy"?this.life=t=="once"?1:this.totalEmitTimes:isNaN(e)||(this.life=e),this.rate.init()},_.prototype.stopEmit=function(){this.totalEmitTimes=-1,this.currentEmitTime=0},_.prototype.removeAllParticles=function(){for(var t=this.particles.length;t--;)this.particles[t].dead=!0},_.prototype.createParticle=function(t,e){var n=this.parent.pool.get(r.Particle);return this.setupParticle(n,t,e),this.parent&&this.parent.dispatchEvent("PARTICLE_CREATED",n),r.bindEmtterEvent&&this.dispatchEvent("PARTICLE_CREATED",n),n},_.prototype.addSelfInitialize=function(t){t.init?t.init(this):this.initAll()},_.prototype.addInitialize=function(){for(var t=arguments.length;t--;)this.initializes.push(arguments[t])},_.prototype.removeInitialize=function(t){var e=this.initializes.indexOf(t);e>-1&&this.initializes.splice(e,1)},_.prototype.removeInitializers=function(){r.Util.destroyArray(this.initializes)},_.prototype.addBehaviour=function(){for(var t=arguments.length;t--;)this.behaviours.push(arguments[t])},_.prototype.removeBehaviour=function(t){var e=this.behaviours.indexOf(t);e>-1&&this.behaviours.splice(e,1)},_.prototype.removeAllBehaviours=function(){r.Util.destroyArray(this.behaviours)},_.prototype.integrate=function(t){var e=1-this.damping;r.integrator.integrate(this,t,e);for(var n=this.particles.length;n--;){var d=this.particles[n];d.update(t,n),r.integrator.integrate(d,t,e),this.parent&&this.parent.dispatchEvent("PARTICLE_UPDATE",d),r.bindEmtterEvent&&this.dispatchEvent("PARTICLE_UPDATE",d)}},_.prototype.emitting=function(t){if(this.totalEmitTimes=="once"){var e=this.rate.getValue(99999);for(e>0&&(this.cID=e);e--;)this.createParticle();this.totalEmitTimes="none"}else if(!isNaN(this.totalEmitTimes)&&(this.currentEmitTime+=t,this.currentEmitTime<this.totalEmitTimes)){var e=this.rate.getValue(t);for(e>0&&(this.cID=e);e--;)this.createParticle()}},_.prototype.update=function(t){this.age+=t,(this.dead||this.age>=this.life)&&this.destroy(),this.emitting(t),this.integrate(t);for(var e,n=this.particles.length;n--;)e=this.particles[n],e.dead&&(this.parent&&this.parent.dispatchEvent("PARTICLE_DEAD",e),r.bindEmtterEvent&&this.dispatchEvent("PARTICLE_DEAD",e),this.parent.pool.expire(e.reset()),this.particles.splice(n,1))},_.prototype.setupParticle=function(t,e,n){var d=this.initializes,y=this.behaviours;e&&(r.Util.isArray(e)?d=e:d=[e]),n&&(r.Util.isArray(n)?y=n:y=[n]),r.InitializeUtil.initialize(this,t,d),t.addBehaviours(y),t.parent=this,this.particles.push(t)},_.prototype.destroy=function(){this.dead=!0,this.energy=0,this.totalEmitTimes=-1,this.particles.length==0&&(this.removeInitializers(),this.removeAllBehaviours(),this.parent&&this.parent.removeEmitter(this))},r.Emitter=_,r.Util.inherits(A,r.Emitter),A.prototype.addSelfBehaviour=function(){var t=arguments.length,e;for(e=0;e<t;e++)this.selfBehaviours.push(arguments[e])},A.prototype.removeSelfBehaviour=function(t){var e=this.selfBehaviours.indexOf(t);e>-1&&this.selfBehaviours.splice(e,1)},A.prototype.update=function(t){if(A._super_.prototype.update.call(this,t),!this.sleep){var e=this.selfBehaviours.length,n;for(n=0;n<e;n++)this.selfBehaviours[n].applyBehaviour(this,t,n)}},r.BehaviourEmitter=A,r.Util.inherits(E,r.Emitter),E.prototype.initEventHandler=function(){var t=this;this.mousemoveHandler=function(e){t.mousemove.call(t,e)},this.mousedownHandler=function(e){t.mousedown.call(t,e)},this.mouseupHandler=function(e){t.mouseup.call(t,e)},this.mouseTarget.addEventListener("mousemove",this.mousemoveHandler,!1)},E.prototype.emit=function(){this._allowEmitting=!0},E.prototype.stopEmit=function(){this._allowEmitting=!1},E.prototype.setCameraAndCanvas=function(t,e){this.camera=t,this.canvas=e},E.prototype.setCameraAndRenderer=function(t,e){this.camera=t,this.renderer=e,this.canvas=e.domElement},E.prototype.mousemove=function(t){var e=this.canvas.getBoundingClientRect(),n=t.clientX-e.left,d=t.clientY-e.top,y=this.renderer?this.renderer.getPixelRatio():1;n*=y,d*=y,this.mouse.x+=(n-this.mouse.x)*this.ease,this.mouse.y+=(d-this.mouse.y)*this.ease,this.p.copy(r.THREEUtil.toSpacePos(this.mouse,this.camera,this.canvas,this.renderer)),this._allowEmitting&&E._super_.prototype.emit.call(this,"once")},E.prototype.destroy=function(){E._super_.prototype.destroy.call(this),this.mouseTarget.removeEventListener("mousemove",this.mousemoveHandler,!1)},r.FollowEmitter=E;var tt=tt||{easeLinear:function(t){return t},easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInSine:function(t){return-Math.cos(t*(r.PI/2))+1},easeOutSine:function(t){return Math.sin(t*(r.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(r.PI*t)-1)},easeInExpo:function(t){return t===0?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return t===1?1:-Math.pow(2,-10*t)+1},easeInOutExpo:function(t){return t===0?0:t===1?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t=t-1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},setEasingByName:function(t){return tt[t]?tt[t]:tt.easeLinear}};for(var Rt in tt)Rt!="setEasingByName"&&(r[Rt]=tt[Rt]);r.ease=tt,R.prototype={init:function(t){var e=this;this.proton=t,this.proton.addEventListener("PROTON_UPDATE",function(n){e.onProtonUpdate.call(e,n)}),this.proton.addEventListener("PARTICLE_CREATED",function(n){e.onParticleCreated.call(e,n)}),this.proton.addEventListener("PARTICLE_UPDATE",function(n){e.onParticleUpdate.call(e,n)}),this.proton.addEventListener("PARTICLE_DEAD",function(n){e.onParticleDead.call(e,n)})},remove:function(t){this.proton=null},onParticleCreated:function(t){},onParticleUpdate:function(t){},onParticleDead:function(t){},onProtonUpdate:function(t){}},r.BaseRender=R,r.Util.inherits(x,r.BaseRender),x.prototype.onProtonUpdate=function(){},x.prototype.onParticleCreated=function(t){t.target||(t.body||(t.body=this._body),t.target=this._targetPool.get(t.body),(t.useAlpha||t.useColor)&&(t.target.material.__puid=r.PUID.id(t.body.material),t.target.material=this._materialPool.get(t.target.material))),t.target&&(t.target.position.copy(t.p),this.container.add(t.target))},x.prototype.onParticleUpdate=function(t){t.target&&(t.target.position.copy(t.p),t.target.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),this.scale(t),t.useAlpha&&(t.target.material.opacity=t.alpha,t.target.material.transparent=!0),t.useColor&&t.target.material.color.copy(t.color))},x.prototype.scale=function(t){t.target.scale.set(t.scale,t.scale,t.scale)},x.prototype.onParticleDead=function(t){t.target&&((t.useAlpha||t.useColor)&&this._materialPool.expire(t.target.material),this._targetPool.expire(t.target),this.container.remove(t.target),t.target=null)},r.MeshRender=x,r.Util.inherits(g,r.BaseRender),g.prototype.onProtonUpdate=function(){},g.prototype.onParticleCreated=function(t){t.target||(t.target=new i.Vector3),t.target.copy(t.p),this.points.geometry.vertices.push(t.target)},g.prototype.onParticleUpdate=function(t){t.target&&t.target.copy(t.p)},g.prototype.onParticleDead=function(t){if(t.target){var e=this.points.geometry.vertices.indexOf(t.target);e>-1&&this.points.geometry.vertices.splice(e,1),t.target=null}},r.PointsRender=g,r.Util.inherits(f,r.MeshRender),f.prototype.scale=function(t){t.target.scale.set(t.scale*t.radius,t.scale*t.radius,1)},r.SpriteRender=f,r.Util.inherits(m,r.BaseRender),m.prototype.onProtonUpdate=function(){},m.prototype.onParticleCreated=function(t){},m.prototype.onParticleUpdate=function(t){},m.prototype.onParticleDead=function(t){},r.CustomRender=m,p.prototype={getPosition:function(){return null},crossing:function(t){switch(this.crossType){case"bound":this._bound(t);break;case"cross":this._cross(t);break;case"dead":this._dead(t)}},_dead:function(t){},_bound:function(t){},_cross:function(t){}},r.Zone=p,r.Util.inherits(u,r.Zone),u.prototype.getPosition=function(){return this.random=Math.random(),this.vector.x=this.x1+this.random*(this.x2-this.x1),this.vector.y=this.y1+this.random*(this.y2-this.y1),this.vector.z=this.z1+this.random*(this.z2-this.z1),this.vector},u.prototype.crossing=function(t){this.log&&(console.error("Sorry LineZone does not support crossing method"),this.log=!1)},r.LineZone=u,r.Util.inherits(l,r.Zone),l.prototype.getPosition=function(){var t,e,n;return function(){return this.random=Math.random(),n=this.random*this.radius,t=r.PI*Math.random(),e=r.PI*2*Math.random(),this.vector.x=this.x+n*Math.sin(t)*Math.cos(e),this.vector.y=this.y+n*Math.sin(e)*Math.sin(t),this.vector.z=this.z+n*Math.cos(t),this.vector}}(),l.prototype._dead=function(t){var e=t.p.distanceTo(this);e-t.radius>this.radius&&(t.dead=!0)},l.prototype._bound=function(){var t=new r.Vector3D,e=new r.Vector3D,n;return function(d){var y=d.p.distanceTo(this);y+d.radius>=this.radius&&(t.copy(d.p).sub(this).normalize(),e.copy(d.v),n=2*e.dot(t),d.v.sub(t.scalar(n)))}}(),l.prototype._cross=function(t){this.log&&(console.error("Sorry SphereZone does not support _cross method"),this.log=!1)},r.SphereZone=l,r.Util.inherits(a,r.Zone),a.prototype.getPosition=function(){var t=this.geometry.vertices,e=t[t.length*Math.random()>>0];return this.vector.x=e.x*this.scale,this.vector.y=e.y*this.scale,this.vector.z=e.z*this.scale,this.vector},a.prototype.crossing=function(t){this.log&&(console.error("Sorry MeshZone does not support crossing method"),this.log=!1)},r.MeshZone=a,r.Util.inherits(h,r.Zone),h.prototype.getPosition=function(){return this.vector.x=this.x,this.vector.y=this.y,this.vector.z=this.z,this.vector},h.prototype.crossing=function(t){this.log&&(console.error("Sorry PointZone does not support crossing method"),this.log=!1)},r.PointZone=h,r.Util.inherits(o,r.Zone),o.prototype.getPosition=function(){return this.vector.x=this.x+r.MathUtils.randomAToB(-.5,.5)*this.width,this.vector.y=this.y+r.MathUtils.randomAToB(-.5,.5)*this.height,this.vector.z=this.z+r.MathUtils.randomAToB(-.5,.5)*this.depth,this.vector},o.prototype._dead=function(t){(t.p.x+t.radius<this.x-this.width/2||t.p.x-t.radius>this.x+this.width/2)&&(t.dead=!0),(t.p.y+t.radius<this.y-this.height/2||t.p.y-t.radius>this.y+this.height/2)&&(t.dead=!0),(t.p.z+t.radius<this.z-this.depth/2||t.p.z-t.radius>this.z+this.depth/2)&&(t.dead=!0)},o.prototype._bound=function(t){t.p.x-t.radius<this.x-this.width/2?(t.p.x=this.x-this.width/2+t.radius,t.v.x*=-this.friction,this._static(t,"x")):t.p.x+t.radius>this.x+this.width/2&&(t.p.x=this.x+this.width/2-t.radius,t.v.x*=-this.friction,this._static(t,"x")),t.p.y-t.radius<this.y-this.height/2?(t.p.y=this.y-this.height/2+t.radius,t.v.y*=-this.friction,this._static(t,"y")):t.p.y+t.radius>this.y+this.height/2&&(t.p.y=this.y+this.height/2-t.radius,t.v.y*=-this.friction,this._static(t,"y")),t.p.z-t.radius<this.z-this.depth/2?(t.p.z=this.z-this.depth/2+t.radius,t.v.z*=-this.friction,this._static(t,"z")):t.p.z+t.radius>this.z+this.depth/2&&(t.p.z=this.z+this.depth/2-t.radius,t.v.z*=-this.friction,this._static(t,"z"))},o.prototype._static=function(t,e){t.v[e]*t.a[e]>0||Math.abs(t.v[e])<Math.abs(t.a[e])*.0167*this.max&&(t.v[e]=0,t.a[e]=0)},o.prototype._cross=function(t){t.p.x+t.radius<this.x-this.width/2&&t.v.x<=0?t.p.x=this.x+this.width/2+t.radius:t.p.x-t.radius>this.x+this.width/2&&t.v.x>=0&&(t.p.x=this.x-this.width/2-t.radius),t.p.y+t.radius<this.y-this.height/2&&t.v.y<=0?t.p.y=this.y+this.height/2+t.radius:t.p.y-t.radius>this.y+this.height/2&&t.v.y>=0&&(t.p.y=this.y-this.height/2-t.radius),t.p.z+t.radius<this.z-this.depth/2&&t.v.z<=0?t.p.z=this.z+this.depth/2+t.radius:t.p.z-t.radius>this.z+this.depth/2&&t.v.z>=0&&(t.p.z=this.z-this.depth/2-t.radius)},r.BoxZone=o,r.Util.inherits(c,r.Zone),c.prototype.getPosition=function(){var t=new r.Vector3D,e;return function(){return e=this.renderer.domElement,t.x=Math.random()*e.width,t.y=Math.random()*e.height,this.vector.copy(r.THREEUtil.toSpacePos(t,this.camera,e)),this.vector}}(),c.prototype._dead=function(t){var e=r.THREEUtil.toScreenPos(t.p,this.camera,this.renderer.domElement),n=this.renderer.domElement;(e.y+t.radius<-this.dis&&this.d1||e.y-t.radius>n.height+this.dis&&this.d3)&&(t.dead=!0),(e.x+t.radius<-this.dis&&this.d4||e.x-t.radius>n.width+this.dis&&this.d2)&&(t.dead=!0)},c.prototype._cross=function(){var t=new r.Vector3D;return function(e){var n=r.THREEUtil.toScreenPos(e.p,this.camera,this.renderer.domElement),d=this.renderer.domElement;n.y+e.radius<-this.dis?(t.x=n.x,t.y=d.height+this.dis+e.radius,e.p.y=r.THREEUtil.toSpacePos(t,this.camera,d).y):n.y-e.radius>d.height+this.dis&&(t.x=n.x,t.y=-this.dis-e.radius,e.p.y=r.THREEUtil.toSpacePos(t,this.camera,d).y),n.x+e.radius<-this.dis?(t.y=n.y,t.x=d.width+this.dis+e.radius,e.p.x=r.THREEUtil.toSpacePos(t,this.camera,d).x):n.x-e.radius>d.width+this.dis&&(t.y=n.y,t.x=-this.dis-e.radius,e.p.x=r.THREEUtil.toSpacePos(t,this.camera,d).x)}}(),c.prototype._bound=function(t){var e=r.THREEUtil.toScreenPos(t.p,this.camera,this.renderer.domElement),n=this.renderer.domElement;(e.y+t.radius<-this.dis||e.y-t.radius>n.height+this.dis)&&(t.v.y*=-1),(e.x+t.radius<-this.dis||e.x-t.radius>n.width+this.dis)&&(t.v.y*=-1)},r.ScreenZone=c;var ot=function(){if(window.console&&window.console.trace){var t=Array.prototype.slice.call(arguments),e=arguments[0]+"";if(e.indexOf("+")==0){var n=parseInt(arguments[0]);ot.once<n&&(t.shift(),console.trace.apply(console,t),ot.once++)}else t.unshift("+15"),ot.apply(console,t)}};ot.once=0,r.log=ot;var Gt=Gt||{addEventListener:function(t,e){t.addEventListener("PROTON_UPDATE",function(n){e(n)})},drawZone:function(t,e,n){var d,y,T;n instanceof r.PointZone?d=new i.SphereGeometry(15):n instanceof r.LineZone||(n instanceof r.BoxZone?d=new i.BoxGeometry(n.width,n.height,n.depth):n instanceof r.SphereZone?d=new i.SphereGeometry(n.radius,10,10):n instanceof r.MeshZone&&(n.geometry instanceof i.Geometry?d=n.geometry:d=n.geometry.geometry,d=new i.SphereGeometry(n.radius,10,10))),y=new i.MeshBasicMaterial({color:"#2194ce",wireframe:!0}),T=new i.Mesh(d,y),e.add(T),this.addEventListener(t,function(S){T.position.set(n.x,n.y,n.z)})},drawEmitter:function(t,e,n,d){var y=new i.OctahedronGeometry(15),T=new i.MeshBasicMaterial({color:d||"#aaa",wireframe:!0}),S=new i.Mesh(y,T);e.add(S),this.addEventListener(t,function(){S.position.copy(n.p),S.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z)})},renderInfo:function(){function t(n){var d=n.emitters[0];return Math.round(d.p.x)+","+Math.round(d.p.y)+","+Math.round(d.p.z)}function e(n,d){var y=d=="material"?"_materialPool":"_targetPool",T=n.renderers[0];return T[y].cID}return function(n,d){this.addInfo(d);var y="";switch(this._infoType){case 2:y+="emitter:"+n.emitters.length+"<br>",y+="em speed:"+n.emitters[0].cID+"<br>",y+="pos:"+t(n);break;case 3:y+=n.renderers[0].name+"<br>",y+="target:"+e(n,"target")+"<br>",y+="material:"+e(n,"material");break;default:y+="particles:"+n.getCount()+"<br>",y+="pool:"+n.pool.getCount()+"<br>",y+="total:"+(n.getCount()+n.pool.getCount())}this._infoCon.innerHTML=y}}(),addInfo:function(){return function(t){var e=this;if(!this._infoCon){this._infoCon=document.createElement("div"),this._infoCon.style.cssText=["position:fixed;bottom:0px;left:0;cursor:pointer;","opacity:0.9;z-index:10000;padding:10px;font-size:12px;","width:120px;height:50px;background-color:#002;color:#0ff;"].join(""),this._infoType=1,this._infoCon.addEventListener("click",function(y){e._infoType++,e._infoType>3&&(e._infoType=1)},!1);var n,d;switch(t){case 2:n="#201",d="#f08";break;case 3:n="#020",d="#0f0";break;default:n="#002",d="#0ff"}this._infoCon.style["background-color"]=n,this._infoCon.style.color=d}this._infoCon.parentNode||document.body.appendChild(this._infoCon)}}()};return r.Debug=Gt,r})})(de);var Ji=de.exports;const z=ai(Ji),$i={__name:"Drop3D",setup(v){const s=hi(),i=ci(null);let c,o,h,a,l,u,p,m;async function f(){a=new Jt(70,window.innerWidth/window.innerHeight,1,1e3),a.position.z=1e3,h=new ti,h.fog=new ei(16777215,1,1e4),l=new ii,i.value.clientWidth,i.value.clientHeight,l.setSize(window.innerWidth,window.innerHeight),i.value.appendChild(l.domElement);var I=new si(16777215);h.add(I);var w=new Kt(16777215,2,1e3,1);w.position.set(0,200,200),h.add(w)}function g(){u=new ni(a,l.domElement),u.enableDamping=!0,u.autoRotate=!0,u.target.set(0,0,0)}function x(){p=new mi,p.showPanel(0),p.dom.style.position="absolute",p.dom.style.left="0px",p.dom.style.top="0px",i.value.appendChild(p.dom)}function R(){o=new z.Emitter,o.rate=new z.Rate(new z.Span(4,8),new z.Span(.2,.5)),o.addInitialize(new z.Mass(1)),o.addInitialize(new z.Radius(100)),o.addInitialize(new z.Life(2,4)),o.addInitialize(new z.Velocity(400,new z.Vector3D(0,1,0),60)),o.addBehaviour(new z.Rotate("random","random")),o.addBehaviour(new z.Scale(1,.1)),o.addBehaviour(new z.G(6));var I=new z.BoxZone(600);return I.friction=.95,I.max=7,o.addBehaviour(new z.CrossZone(I,"bound")),o.addBehaviour(new z.Color(16711680,"random",1/0,z.easeOutQuart)),o.p.x=0,o.p.y=0,o.emit(),z.Debug.drawZone(c,h,I),o}async function E(I){new $e;var w=new yi;w.load("/models/DamagedHelmet.gltf",function(U){const O=U.scene;console.log(O),m=O.children[0]}),I()}function A(){c=new z,c.addEmitter(R());var I=new z.CustomRender;I.onParticleCreated=function(w){w.target=this.targetPool.get(m),w.target.position.copy(w.p),h.add(w.target)},I.onParticleUpdate=function(w){w.target.position.copy(w.p),w.target.rotation.set(w.rotation.x,w.rotation.y,w.rotation.z);var U=w.scale*30;w.target.scale.set(U,U,U)},I.onParticleDead=function(w){this.targetPool.expire(w.target),h.remove(w.target),w.target=null},c.addRender(I)}let _=!0;function M(){p.begin(),requestAnimationFrame(M),_||P(),p.end()}function P(){c.update(),l.render(h,a),u.update(),z.Debug.renderInfo(c,3)}function L(){f(),A(),x(),g(),M()}function D(){E(L)}return li(()=>{D()}),ui(()=>{l&&l.dispose()}),di(()=>s.LATEST_MSG,I=>{_=!1,setTimeout(()=>{_=!0},5e3)}),(I,w)=>(pi(),fi("div",{ref_key:"el",ref:i,class:"bg-zinc-900 overflow-hidden mx-auto block"},null,512))}};export{$i as default};
